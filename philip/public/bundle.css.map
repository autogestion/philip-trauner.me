{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "../src/Publish.svelte",
    "../src/Activity.svelte",
    "../src/Post.svelte"
  ],
  "sourcesContent": [
    "<script>\n  import { getCreateObject, getHashTag } from \"./utils/pubGate\";\n\n  export let reply = null;\n  export let session;\n\n  let inProgress = false;\n  let content = \"\";\n\n  const hashTagMatcher = /(^|\\W)(#[a-z\\d][\\w-]*)/gi;\n\n  const wrapHashTagsWithLink = text =>\n    text.match(hashTagMatcher)\n      ? text.replace(hashTagMatcher, '$1<a href=\"\" rel=\"tag\">$2</a>')\n      : text;\n\n  const getAllHashTags = text => text.match(hashTagMatcher) || [];\n\n  const publish = async ev => {\n    ev.preventDefault();\n\n    inProgress = true;\n    let tags = getAllHashTags(content)\n      .map(v => v.trim())\n      .map(getHashTag);\n\n    const data = wrapHashTagsWithLink(content);\n\n    let ap_object = getCreateObject(data, tags);\n\n    if (reply) {\n      ap_object.object.inReplyTo = reply.id;\n      ap_object.cc = [reply.attributedTo];\n    }\n\n    try {\n      const response = await fetch(session.user.outbox, {\n        method: \"POST\",\n        body: JSON.stringify(ap_object),\n        headers: { Authorization: \"Bearer \" + session.token },\n      });\n      const data = await response.json();\n    } catch (e) {\n      console.log(e);\n    }\n\n    inProgress = false;\n    content = \"\";\n  };\n</script>\n\n<style>\n  textarea {\n    width: 100%;\n  }\n</style>\n\n<form on:submit={publish}>\n\n  <fieldset class=\"form-group\">\n    <textarea\n      class=\"form-control\"\n      placeholder=\"Write your text here\"\n      bind:value={content} />\n  </fieldset>\n\n  <button\n    class=\"btn btn-sm pull-xs-right btn-info\"\n    disabled={!content || inProgress}>\n    Publish\n  </button>\n\n</form>\n",
    "\n<script>\n\texport let post;\n\texport let session;\n\timport Post from \"./Post.svelte\";\n\timport xhr from \"./utils/xhr\";\n\timport { ensureObject } from \"./utils/objectUtils\";\n\n\tlet postObject;\n\tlet isReaction = false;\n\n\tif ([\"Announce\", \"Like\"].includes(post.type)) {\n\t    postObject = ensureObject(post.object);\n\t    // if (typeof post.object === \"string\") {\n\t    //     fpost = xhr(post.object);\n        //     postObject = fpost => fpost.object;\n\t    // } else {\n\t    //     postObject = post.object;\n\t    // }\n\t    isReaction = true\n    }\n</script>\n\n<style>\n    .reaction {\n        margin-left: 30px;\n    }\n</style>\n\n<li class=\"post\">\n    {#if isReaction == false}\n\n        <h2 id=\"\"> . </h2>\n        <Post post={post.object} session={session}/>\n\n    {:else}\n\n        <div class=\"metadata\">\n            <h2 id=\"\"> . </h2>\n            <a href=\"{post.id}\">{post.type}</a> by user <a href=\"{ post.actor }\">{ post.actor }</a>\n            <span class=\"metadata-seperator\">Â·</span>\n\n            {#if post.published }\n            <span>{ post.published.replace(\"T\", \" \").replace(\"Z\", \" \") }</span>\n            {/if}\n        </div>\n        <div class=\"reaction\">\n            <Post post={postObject} session={session}/>\n        </div>\n\n    {/if}\n</li>",
    "\n<script>\n\texport let post;\n\texport let session;\n\n\timport Publish from \"./Publish.svelte\";\n\timport PostContent from \"./PostContent.svelte\";\n\timport { ensureObject } from \"./utils/objectUtils\";\n\n    let showPublish = false;\n    const togglePublish = ev => {\n        ev.preventDefault();\n        showPublish = !showPublish\n    };\n\n    const toggleLists = ev => {\n        ev.preventDefault();\n    };\n\n    let liked;\n    let announced;\n    if (session.user) {\n\n        if (post.reactions) {\n            if (post.reactions.Like) {\n                if (post.reactions.Like[session.user.name]) {\n                    $: liked = true\n                }\n            }\n        }\n\n        if (post.reactions) {\n            if (post.reactions.Announce) {\n                if (post.reactions.Announce[session.user.name]) {\n                    $: announced = true\n                }\n            }\n        }\n    }\n\n    let inReply;\n    let isReply = false;\n\n    let likes = 'n/a';\n    let comments = 'n/a';\n    let announces = 'n/a';\n\n    if (post.inReplyTo) {\n        inReply = ensureObject(post.inReplyTo);\n        isReply = true\n    }\n\n    if (post.likes) {\n        likes = post.likes.totalItems\n    }\n\n    if (post.shares) {\n        announces = post.shares.totalItems\n    }\n\n    if (post.replies) {\n        comments = post.replies.totalItems\n    }\n\n    let customType = isReply ? \"Reply\" : null\n\n    async function doLike(ev) {\n        ev.preventDefault();\n        if (!liked) {\n            let ap_object = {\n                \"type\": \"Like\",\n                \"object\": post.id ,\n            };\n            const response = await fetch(session.user.outbox, {\n                method: 'POST',\n                body: JSON.stringify(ap_object),\n                headers : {'Authorization': \"Bearer \" + session.token}\n            }).then(d => d.json());\n            $: liked = true\n        }\n    }\n\n    async function doAnnounce(ev) {\n        ev.preventDefault();\n        if (!announced) {\n            let ap_object = {\n                \"type\": \"Announce\",\n                \"object\": post.id ,\n            };\n            const response = await fetch(session.user.outbox, {\n                method: 'POST',\n                body: JSON.stringify(ap_object),\n                headers : {'Authorization': \"Bearer \" + session.token}\n            }).then(d => d.json());\n            $: announced = true\n        }\n    }\n\n\n</script>\n<style>\n.reactionz {\n    font-size: 18px;\n}\n.rs {\n    border-bottom: 1px solid #dadde1;\n    display: flex;\n}\n.ra {\n    padding: 4px 0;\n    display: flex;\n}\n\n.rs_left {\n    flex-grow: 1;\n}\n.rs_right {\n    margin-left: 7px;\n}\n.ra_item {\n    flex: 1 0;\n    align-items: center;\n    color: #606770;\n    display: flex;\n    font-weight: 600;\n    height: 32px;\n    justify-content: center;\n}\n\n.reaction {\n    margin-left: 30px;\n}\n\n</style>\n\n{#if isReply == true}\n    <div class=\"reaction\">\n        {#if typeof(inReply) === 'object' && typeof(inReply.id) != 'string'}\n            {#await inReply then value}\n                <PostContent post={value}/>\n            {/await}\n         {:else}\n            <PostContent post={inReply}/>\n         {/if}\n    </div>\n{/if}\n\n<PostContent post={post} customType={customType}/>\n\n\n<div class=\"reactionz\">\n    <div class=\"rs\">\n           <a class=\"rs_left\" href=\"\" on:click={toggleLists}>{likes} likes</a>\n           <a class=\"rs_right\" href=\"\" on:click={toggleLists}>{comments} comments</a>\n           <a class=\"rs_right\" href=\"\" on:click={toggleLists}>{announces} announces</a>\n    </div>\n    {#if session.user }\n        <div class=\"ra\">\n            <a class=\"ra_item\" href=\"\"  on:click={doLike}>Like{#if liked}d{/if}</a>\n             <a class=\"ra_item\" href=\"\" on:click={togglePublish}>Add comment</a>\n             <a class=\"ra_item\" href=\"\" on:click={doAnnounce}>Announce{#if announced}d{/if}</a>\n         </div>\n        {#if showPublish}\n            <Publish reply={post} session={session}/>\n        {/if}\n    {/if}\n</div>\n"
  ],
  "names": [],
  "mappings": "AAoDE,QAAQ,eAAC,CAAC,AACR,KAAK,CAAE,IAAI,AACb,CAAC;AC9BC,SAAS,eAAC,CAAC,AACP,WAAW,CAAE,IAAI,AACrB,CAAC;AC2EL,UAAU,cAAC,CAAC,AACR,SAAS,CAAE,IAAI,AACnB,CAAC,AACD,GAAG,cAAC,CAAC,AACD,aAAa,CAAE,GAAG,CAAC,KAAK,CAAC,OAAO,CAChC,OAAO,CAAE,IAAI,AACjB,CAAC,AACD,GAAG,cAAC,CAAC,AACD,OAAO,CAAE,GAAG,CAAC,CAAC,CACd,OAAO,CAAE,IAAI,AACjB,CAAC,AAED,QAAQ,cAAC,CAAC,AACN,SAAS,CAAE,CAAC,AAChB,CAAC,AACD,SAAS,cAAC,CAAC,AACP,WAAW,CAAE,GAAG,AACpB,CAAC,AACD,QAAQ,cAAC,CAAC,AACN,IAAI,CAAE,CAAC,CAAC,CAAC,CACT,WAAW,CAAE,MAAM,CACnB,KAAK,CAAE,OAAO,CACd,OAAO,CAAE,IAAI,CACb,WAAW,CAAE,GAAG,CAChB,MAAM,CAAE,IAAI,CACZ,eAAe,CAAE,MAAM,AAC3B,CAAC,AAED,SAAS,cAAC,CAAC,AACP,WAAW,CAAE,IAAI,AACrB,CAAC"
}