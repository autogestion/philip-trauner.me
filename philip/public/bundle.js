var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function o(){return Object.create(null)}function s(t){t.forEach(n)}function r(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t,e){t.appendChild(e)}function i(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function l(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function p(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function f(){return d(" ")}function m(){return d("")}function h(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function b(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function v(t,e){e=""+e,t.data!==e&&(t.data=e)}let $;function g(t){$=t}function _(){const t=$;return(e,n)=>{const o=t.$$.callbacks[e];if(o){const s=function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(e,n);o.slice().forEach(e=>{e.call(t,s)})}}}const y=[],x=Promise.resolve();let k=!1;const N=[],T=[],w=[];function j(t){T.push(t)}function C(){const t=new Set;do{for(;y.length;){const t=y.shift();g(t),E(t.$$)}for(;N.length;)N.shift()();for(;T.length;){const e=T.pop();t.has(e)||(e(),t.add(e))}}while(y.length);for(;w.length;)w.pop()();k=!1}function E(t){t.fragment&&(t.update(t.dirty),s(t.before_render),t.fragment.p(t.dirty,t.ctx),t.dirty=null,t.after_render.forEach(j))}let L;function A(){L={remaining:0,callbacks:[]}}function M(){L.remaining||s(L.callbacks)}function O(t){L.callbacks.push(t)}function P(t,n){const o=n.token={};function s(t,s,r,a){if(n.token!==o)return;n.resolved=r&&{[r]:a};const c=e(e({},n.ctx),n.resolved),i=t&&(n.current=t)(c);n.block&&(n.blocks?n.blocks.forEach((t,e)=>{e!==s&&t&&(A(),O(()=>{t.d(1),n.blocks[e]=null}),t.o(1),M())}):n.block.d(1),i.c(),i.i&&i.i(1),i.m(n.mount(),n.anchor),C()),n.block=i,n.blocks&&(n.blocks[s]=i)}if((r=t)&&"function"==typeof r.then){if(t.then(t=>{s(n.then,1,n.value,t)},t=>{s(n.catch,2,n.error,t)}),n.current!==n.pending)return s(n.pending,0),!0}else{if(n.current!==n.then)return s(n.then,1,n.value,t),!0;n.resolved={[n.value]:t}}var r}function S(t,e,o){const{fragment:a,on_mount:c,on_destroy:i,after_render:u}=t.$$;a.m(e,o),j(()=>{const e=c.map(n).filter(r);i?i.push(...e):s(e),t.$$.on_mount=[]}),u.forEach(j)}function H(t,e){t.$$.dirty||(y.push(t),k||(k=!0,x.then(C)),t.$$.dirty=o()),t.$$.dirty[e]=!0}function Z(e,n,r,a,c,i){const u=$;g(e);const l=n.props||{},p=e.$$={fragment:null,ctx:null,props:i,update:t,not_equal:c,bound:o(),on_mount:[],on_destroy:[],before_render:[],after_render:[],context:new Map(u?u.$$.context:[]),callbacks:o(),dirty:null};let d=!1;var f;p.ctx=r?r(e,l,(t,n)=>{p.ctx&&c(p.ctx[t],p.ctx[t]=n)&&(p.bound[t]&&p.bound[t](n),d&&H(e,t))}):l,p.update(),d=!0,s(p.before_render),p.fragment=a(p.ctx),n.target&&(n.hydrate?p.fragment.l((f=n.target,Array.from(f.childNodes))):p.fragment.c(),n.intro&&e.$$.fragment.i&&e.$$.fragment.i(),S(e,n.target,n.anchor),C()),g(u)}class B{$destroy(){var e,n;n=!0,(e=this).$$&&(s(e.$$.on_destroy),e.$$.fragment.d(n),e.$$.on_destroy=e.$$.fragment=null,e.$$.ctx={}),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}function q(t,e,n){const o=Object.create(t);return o.tag=e[n],o}function D(t){for(var e,n,o,s,r,a,m,h,b,$,g,_,y,x,k,N,T,w=t.post.type,j=t.post.attributedTo.split("/").pop(),C=t.post.published.replace("T"," ").replace("Z"," "),E=t.post.content,L=t.post.tag,A=[],M=0;M<L.length;M+=1)A[M]=G(q(t,L,M));return{c(){e=p("div"),n=p("a"),o=d(w),r=d(" by user "),a=p("a"),m=d(j),b=f(),($=p("span")).textContent="·",g=f(),_=p("span"),y=d(C),x=f(),k=p("div");for(var c=0;c<A.length;c+=1)A[c].c();N=f(),T=p("p"),n.href=s=t.post.id,a.href=h=t.post.attributedTo,$.className="metadata-seperator",e.className="metadata",k.className="tags"},m(t,s){i(t,e,s),c(e,n),c(n,o),c(e,r),c(e,a),c(a,m),c(e,b),c(e,$),c(e,g),c(e,_),c(_,y),i(t,x,s),i(t,k,s);for(var u=0;u<A.length;u+=1)A[u].m(k,null);i(t,N,s),i(t,T,s),T.innerHTML=E},p(t,e){if(t.post&&w!==(w=e.post.type)&&v(o,w),t.post&&s!==(s=e.post.id)&&(n.href=s),t.post&&j!==(j=e.post.attributedTo.split("/").pop())&&v(m,j),t.post&&h!==(h=e.post.attributedTo)&&(a.href=h),t.post&&C!==(C=e.post.published.replace("T"," ").replace("Z"," "))&&v(y,C),t.post){L=e.post.tag;for(var r=0;r<L.length;r+=1){const n=q(e,L,r);A[r]?A[r].p(t,n):(A[r]=G(n),A[r].c(),A[r].m(k,null))}for(;r<A.length;r+=1)A[r].d(1);A.length=L.length}t.post&&E!==(E=e.post.content)&&(T.innerHTML=E)},d(t){t&&(u(e),u(x),u(k)),l(A,t),t&&(u(N),u(T))}}}function F(t){var e;return{c(){e=p("p")},m(n,o){i(n,e,o),e.innerHTML=t.post},p(t,n){t.post&&(e.innerHTML=n.post)},d(t){t&&u(e)}}}function G(t){var e,n,o,s=t.tag.name;return{c(){e=p("a"),n=d(s),e.className="tag",e.href=o=t.tag.href},m(t,o){i(t,e,o),c(e,n)},p(t,r){t.post&&s!==(s=r.tag.name)&&v(n,s),t.post&&o!==(o=r.tag.href)&&(e.href=o)},d(t){t&&u(e)}}}function I(e){var n;function o(t){return"string"==typeof t.post?F:D}var s=o(e),r=s(e);return{c(){r.c(),n=m()},m(t,e){r.m(t,e),i(t,n,e)},p(t,e){s===(s=o(e))&&r?r.p(t,e):(r.d(1),(r=s(e))&&(r.c(),r.m(n.parentNode,n)))},i:t,o:t,d(t){r.d(t),t&&u(n)}}}function z(t,e,n){let{post:o}=e;return t.$set=(t=>{"post"in t&&n("post",o=t.post)}),{post:o}}class J extends B{constructor(t){super(),Z(this,t,z,I,a,["post"])}}function U(t){var e,n,o,s,r,a,l,m,h,b,$,g,_,y,x,k,N,T=t.post.type,w=t.post.actor.split("/").slice(-1)[0],j=t.post.published&&Q(t),C=new J({props:{post:t.post_object}});return{c(){e=p("li"),n=p("div"),(o=p("h2")).textContent=".",s=f(),r=p("a"),a=d(T),m=d(" by user "),h=p("a"),b=d(w),g=f(),(_=p("span")).textContent="·",y=f(),j&&j.c(),x=f(),k=p("div"),C.$$.fragment.c(),o.id="",r.href=l=t.post.id,h.href=$=t.post.actor,_.className="metadata-seperator",n.className="metadata",k.className="reaction svelte-1gf6p2q",e.className="post"},m(t,u){i(t,e,u),c(e,n),c(n,o),c(n,s),c(n,r),c(r,a),c(n,m),c(n,h),c(h,b),c(n,g),c(n,_),c(n,y),j&&j.m(n,null),c(e,x),c(e,k),S(C,k,null),N=!0},p(t,e){N&&!t.post||T===(T=e.post.type)||v(a,T),N&&!t.post||l===(l=e.post.id)||(r.href=l),N&&!t.post||w===(w=e.post.actor.split("/").slice(-1)[0])||v(b,w),N&&!t.post||$===($=e.post.actor)||(h.href=$),e.post.published?j?j.p(t,e):((j=Q(e)).c(),j.m(n,null)):j&&(j.d(1),j=null);var o={};t.post_object&&(o.post=e.post_object),C.$set(o)},i(t){N||(C.$$.fragment.i(t),N=!0)},o(t){C.$$.fragment.o(t),N=!1},d(t){t&&u(e),j&&j.d(),C.$destroy()}}}function K(t){var e,n,o,s,r=new J({props:{post:t.post.object}});return{c(){e=p("li"),(n=p("h2")).textContent=".",o=f(),r.$$.fragment.c(),n.id="",e.className="post"},m(t,a){i(t,e,a),c(e,n),c(e,o),S(r,e,null),s=!0},p(t,e){var n={};t.post&&(n.post=e.post.object),r.$set(n)},i(t){s||(r.$$.fragment.i(t),s=!0)},o(t){r.$$.fragment.o(t),s=!1},d(t){t&&u(e),r.$destroy()}}}function Q(t){var e,n,o=t.post.published.replace("T"," ").replace("Z"," ");return{c(){e=p("span"),n=d(o)},m(t,o){i(t,e,o),c(e,n)},p(t,e){t.post&&o!==(o=e.post.published.replace("T"," ").replace("Z"," "))&&v(n,o)},d(t){t&&u(e)}}}function R(t){var e,n,o,s,r=[K,U],a=[];function c(t){return 0==t.fetched_post?0:1}return e=c(t),n=a[e]=r[e](t),{c(){n.c(),o=m()},m(t,n){a[e].m(t,n),i(t,o,n),s=!0},p(t,s){var i=e;(e=c(s))===i?a[e].p(t,s):(A(),O(()=>{a[i].d(1),a[i]=null}),n.o(1),M(),(n=a[e])||(n=a[e]=r[e](s)).c(),n.i(1),n.m(o.parentNode,o))},i(t){s||(n&&n.i(),s=!0)},o(t){n&&n.o(),s=!1},d(t){a[e].d(t),t&&u(o)}}}function V(t,e,n){let o,s,{post:r}=e,a=!1;return["Announce","Like"].includes(r.type)&&(0==pubgate_instance?(n("fpost",o=fetch(r.object,{headers:{Accept:"application/activity+json"}}).then(t=>t.json())),n("post_object",s=(t=>t.object))):n("post_object",s=r.object),n("fetched_post",a=!0)),t.$set=(t=>{"post"in t&&n("post",r=t.post)}),{post:r,post_object:s,fetched_post:a}}class W extends B{constructor(t){super(),Z(this,t,V,R,a,["post"])}}function X(t,e,n){const o=Object.create(t);return o.post=e[n],o}function Y(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function tt(t){for(var e,n,o=t.value,s=[],r=0;r<o.length;r+=1)s[r]=et(X(t,o,r));function a(t,e,n){s[t]&&(e&&O(()=>{s[t].d(e),s[t]=null}),s[t].o(n))}return{c(){e=p("ul");for(var t=0;t<s.length;t+=1)s[t].c();e.className="post-list"},m(t,o){i(t,e,o);for(var r=0;r<s.length;r+=1)s[r].m(e,null);n=!0},p(t,n){if(t.posts){o=n.value;for(var r=0;r<o.length;r+=1){const a=X(n,o,r);s[r]?(s[r].p(t,a),s[r].i(1)):(s[r]=et(a),s[r].c(),s[r].i(1),s[r].m(e,null))}for(A();r<s.length;r+=1)a(r,1,1);M()}},i(t){if(!n){for(var e=0;e<o.length;e+=1)s[e].i();n=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)a(t,0);n=!1},d(t){t&&u(e),l(s,t)}}}function et(t){var e,n=new W({props:{post:t.post}});return{c(){n.$$.fragment.c()},m(t,o){S(n,t,o),e=!0},p(t,e){var o={};t.posts&&(o.post=e.post),n.$set(o)},i(t){e||(n.$$.fragment.i(t),e=!0)},o(t){n.$$.fragment.o(t),e=!1},d(t){n.$destroy(t)}}}function nt(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function ot(t){var n,o,s;let r={ctx:t,current:null,pending:nt,then:tt,catch:Y,value:"value",error:"null",blocks:Array(3)};return P(o=t.posts,r),{c(){n=m(),r.block.c()},m(t,e){i(t,n,e),r.block.m(t,r.anchor=e),r.mount=(()=>n.parentNode),r.anchor=n,s=!0},p(n,s){t=s,r.ctx=t,"posts"in n&&o!==(o=t.posts)&&P(o,r)||r.block.p(n,e(e({},t),r.resolved))},i(t){s||(r.block.i(),s=!0)},o(t){for(let t=0;t<3;t+=1){const e=r.blocks[t];e&&e.o()}s=!1},d(t){t&&u(n),r.block.d(t),r=null}}}function st(t,e,n){let{active_tab:o,session:s}=e,r=pubgate_instance;const a=function(t,e={}){let n={Accept:"application/activity+json"};return e.user&&(n.Authorization="Bearer "+e.token),fetch(t,{headers:n}).then(t=>t.json()).then(t=>t.first.orderedItems)};let c;return t.$set=(t=>{"active_tab"in t&&n("active_tab",o=t.active_tab),"session"in t&&n("session",s=t.session)}),t.$$.update=((t={active_tab:1,session:1})=>{(t.active_tab||t.session)&&n("posts",c=function(t,e){switch(t){case"local":return r?a(base_url+"/timeline/local?cached=1"):[];case"federated":return r?a(base_url+"/timeline/federated?cached=1"):[];case"inbox":return a(r?e.user.inbox+"?cached=1":e.user.inbox,e);case"profile":return a(r?e.user.outbox+"?cached=1":e.user.outbox);default:return[]}}(o,s))}),{active_tab:o,session:s,posts:c}}class rt extends B{constructor(t){super(),Z(this,t,st,ot,a,["active_tab","session"])}}function at(t){var e,n=new rt({props:{active_tab:t.active_tab,session:t.session}});return{c(){n.$$.fragment.c()},m(t,o){S(n,t,o),e=!0},p(t,e){var o={};t.active_tab&&(o.active_tab=e.active_tab),t.session&&(o.session=e.session),n.$set(o)},i(t){e||(n.$$.fragment.i(t),e=!0)},o(t){n.$$.fragment.o(t),e=!1},d(t){n.$destroy(t)}}}function ct(t){var e,n,o,s,r=[ut,it],a=[];function c(t){return t.session.user?0:1}return e=c(t),n=a[e]=r[e](t),{c(){n.c(),o=m()},m(t,n){a[e].m(t,n),i(t,o,n),s=!0},p(t,s){var i=e;(e=c(s))===i?a[e].p(t,s):(A(),O(()=>{a[i].d(1),a[i]=null}),n.o(1),M(),(n=a[e])||(n=a[e]=r[e](s)).c(),n.i(1),n.m(o.parentNode,o))},i(t){s||(n&&n.i(),s=!0)},o(t){n&&n.o(),s=!1},d(t){a[e].d(t),t&&u(o)}}}function it(e){var n,o,r,a,l,m,v,$,g,_,y;return{c(){var t;n=p("form"),o=p("fieldset"),r=p("input"),a=f(),l=p("fieldset"),m=p("input"),v=f(),$=p("button"),g=d("Sign in"),r.className="form-control form-control-lg",b(r,"type","username"),r.placeholder="Username",o.className="form-group",m.className="form-control form-control-lg",b(m,"type","password"),m.placeholder="Password",l.className="form-group",$.className="btn btn-lg btn-primary pull-xs-right",$.type="submit",$.disabled=_=!e.username||!e.password,y=[h(r,"input",e.input0_input_handler),h(m,"input",e.input1_input_handler),h(n,"submit",(t=e.login,function(e){return e.preventDefault(),t.call(this,e)}))]},m(t,s){i(t,n,s),c(n,o),c(o,r),r.value=e.username,c(n,a),c(n,l),c(l,m),m.value=e.password,c(n,v),c(n,$),c($,g)},p(t,e){t.username&&(r.value=e.username),t.password&&(m.value=e.password),(t.username||t.password)&&_!==(_=!e.username||!e.password)&&($.disabled=_)},i:t,o:t,d(t){t&&u(n),s(y)}}}function ut(t){var e,n,o,s,r=new rt({props:{active_tab:t.active_tab,session:t.session}});return{c(){(e=p("button")).textContent="Logout",n=f(),r.$$.fragment.c(),e.className="btn btn-sm",s=h(e,"click",t.logout)},m(t,s){i(t,e,s),i(t,n,s),S(r,t,s),o=!0},p(t,e){var n={};t.active_tab&&(n.active_tab=e.active_tab),t.session&&(n.session=e.session),r.$set(n)},i(t){o||(r.$$.fragment.i(t),o=!0)},o(t){r.$$.fragment.o(t),o=!1},d(t){t&&(u(e),u(n)),r.$destroy(t),s()}}}function lt(t){var e,n,o,s,r=[ct,at],a=[];function c(t){return"profile"==t.active_tab?0:1}return e=c(t),n=a[e]=r[e](t),{c(){n.c(),o=m()},m(t,n){a[e].m(t,n),i(t,o,n),s=!0},p(t,s){var i=e;(e=c(s))===i?a[e].p(t,s):(A(),O(()=>{a[i].d(1),a[i]=null}),n.o(1),M(),(n=a[e])||(n=a[e]=r[e](s)).c(),n.i(1),n.m(o.parentNode,o))},i(t){s||(n&&n.i(),s=!0)},o(t){n&&n.o(),s=!1},d(t){a[e].d(t),t&&u(o)}}}function pt(t,e,n){const o=_();let{active_tab:s,session:r}=e,a="",c="";return t.$set=(t=>{"active_tab"in t&&n("active_tab",s=t.active_tab),"session"in t&&n("session",r=t.session)}),{active_tab:s,session:r,username:a,password:c,login:async function(t){const e=await fetch(base_url+"/@"+a,{headers:{Accept:"application/activity+json"}}).then(t=>t.json()),s=await fetch(e.endpoints.oauthTokenEndpoint,{method:"POST",body:JSON.stringify({username:a,password:c})}).then(t=>t.json());s.access_token&&(r.user=e,n("session",r),r.token=s.access_token,n("session",r)),o("updatesession",r)},logout:async function(t){n("session",r={}),o("updatesession",r)},input0_input_handler:function(){a=this.value,n("username",a)},input1_input_handler:function(){c=this.value,n("password",c)}}}class dt extends B{constructor(t){super(),Z(this,t,pt,lt,a,["active_tab","session"])}}function ft(e){var n,o,r,a,l,d;return{c(){n=p("li"),(o=p("a")).textContent="Local Timeline",r=f(),a=p("li"),(l=p("a")).textContent="Federated Timeline",o.href="#local",o.className="header-selected",l.href="#federated",d=[h(o,"click",e.selectTab),h(l,"click",e.selectTab)]},m(t,e){i(t,n,e),c(n,o),i(t,r,e),i(t,a,e),c(a,l)},p:t,d(t){t&&(u(n),u(r),u(a)),s(d)}}}function mt(e){var n,o,r,a,l,d;return{c(){n=p("li"),(o=p("a")).textContent="Inbox",r=f(),a=p("li"),(l=p("a")).textContent="Create",o.href="#inbox",l.href="#create",d=[h(o,"click",e.selectTab),h(l,"click",e.selectTab)]},m(t,e){i(t,n,e),c(n,o),i(t,r,e),i(t,a,e),c(a,l)},p:t,d(t){t&&(u(n),u(r),u(a)),s(d)}}}function ht(t){var e;return{c(){e=d("Login")},m(t,n){i(t,e,n)},d(t){t&&u(e)}}}function bt(t){var e;return{c(){e=d("Profile")},m(t,n){i(t,e,n)},d(t){t&&u(e)}}}function vt(t){var e,n,o,r,a,l,d,m,b,v,$,g,_,y,x,k,N,T=1==t.pgi&&ft(t),w=t.session.user&&mt(t);function j(t){return t.session.user?bt:ht}var C=j(t),E=C(t),L=new dt({props:{active_tab:t.active_tab,session:t.session}});return L.$on("updatesession",t.updateSession),{c(){e=p("header"),n=p("ul"),T&&T.c(),o=f(),w&&w.c(),r=f(),a=p("li"),l=p("a"),E.c(),d=f(),m=p("li"),(b=p("a")).textContent="About",v=f(),$=p("div"),L.$$.fragment.c(),g=f(),_=p("hr"),y=f(),(x=p("footer")).innerHTML='<div class="left-column"><h2>PubGate-Philip</h2>\n\t\t\t        <p>Gotta<br>go<br>Fast</p></div>\n\t\t\t    <div class="right-column"><h2>Contact</h2>\n\t\t\t        <p></p></div>',l.href="#profile",b.href="#about",$.className="content",_.className="separator",x.className="content",N=[h(l,"click",t.selectTab),h(b,"click",t.selectTab)]},m(t,s){i(t,e,s),c(e,n),T&&T.m(n,null),c(n,o),w&&w.m(n,null),c(n,r),c(n,a),c(a,l),E.m(l,null),c(n,d),c(n,m),c(m,b),i(t,v,s),i(t,$,s),S(L,$,null),i(t,g,s),i(t,_,s),i(t,y,s),i(t,x,s),k=!0},p(t,e){1==e.pgi?T?T.p(t,e):((T=ft(e)).c(),T.m(n,o)):T&&(T.d(1),T=null),e.session.user?w?w.p(t,e):((w=mt(e)).c(),w.m(n,r)):w&&(w.d(1),w=null),C!==(C=j(e))&&(E.d(1),(E=C(e))&&(E.c(),E.m(l,null)));var s={};t.active_tab&&(s.active_tab=e.active_tab),t.session&&(s.session=e.session),L.$set(s)},i(t){k||(L.$$.fragment.i(t),k=!0)},o(t){L.$$.fragment.o(t),k=!1},d(t){t&&u(e),T&&T.d(),w&&w.d(),E.d(),t&&(u(v),u($)),L.$destroy(),t&&(u(g),u(_),u(y),u(x)),s(N)}}}function $t(t,e,n){let o,s={},r=pubgate_instance;n("active_tab",o=r?"local":"about");return{session:s,active_tab:o,pgi:r,selectTab:function(t){t.preventDefault(),n("active_tab",o=this.href.split("#")[1]),Array.prototype.forEach.call(this.parentNode.parentNode.children,(t,e)=>{t.firstChild.href.split("#")[1]!==o&&t.firstChild.classList.remove("header-selected")}),this.classList.add("header-selected")},updateSession:t=>{n("session",s=t.detail)}}}return new class extends B{constructor(t){super(),Z(this,t,$t,vt,a,[])}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
