var app=function(){"use strict";function e(){}function t(e,t){for(const n in t)e[n]=t[n];return e}function n(e){return e()}function o(){return Object.create(null)}function s(e){e.forEach(n)}function r(e){return"function"==typeof e}function c(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function u(e,t,n){e.$$.on_destroy.push(function(e,t){const n=e.subscribe(t);return n.unsubscribe?()=>n.unsubscribe():n}(t,n))}function i(e,t){e.appendChild(t)}function l(e,t,n){e.insertBefore(t,n||null)}function a(e){e.parentNode.removeChild(e)}function p(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function d(e){return document.createElement(e)}function m(e){return document.createTextNode(e)}function f(){return m(" ")}function h(){return m("")}function b(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function g(e){return function(t){return t.preventDefault(),e.call(this,t)}}function $(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}function v(e,t){t=""+t,e.data!==t&&(e.data=t)}let R;function y(e){R=e}function k(e){(function(){if(!R)throw new Error("Function called outside component initialization");return R})().$$.on_destroy.push(e)}function x(){const e=R;return(t,n)=>{const o=e.$$.callbacks[t];if(o){const s=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);o.slice().forEach(t=>{t.call(e,s)})}}}const _=[],w=[],T=[],j=[],P=Promise.resolve();let S=!1;function N(e){T.push(e)}function L(){const e=new Set;do{for(;_.length;){const e=_.shift();y(e),O(e.$$)}for(;w.length;)w.pop()();for(let t=0;t<T.length;t+=1){const n=T[t];e.has(n)||(n(),e.add(n))}T.length=0}while(_.length);for(;j.length;)j.pop()();S=!1}function O(e){e.fragment&&(e.update(e.dirty),s(e.before_update),e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_update.forEach(N))}const A=new Set;let C;function U(){C={r:0,c:[],p:C}}function E(){C.r||s(C.c),C=C.p}function I(e,t){e&&e.i&&(A.delete(e),e.i(t))}function J(e,t,n,o){if(e&&e.o){if(A.has(e))return;A.add(e),C.c.push(()=>{A.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}}function F(e,n){const o=n.token={};function s(e,s,r,c){if(n.token!==o)return;n.resolved=r&&{[r]:c};const u=t(t({},n.ctx),n.resolved),i=e&&(n.current=e)(u);n.block&&(n.blocks?n.blocks.forEach((e,t)=>{t!==s&&e&&(U(),J(e,1,1,()=>{n.blocks[t]=null}),E())}):n.block.d(1),i.c(),I(i,1),i.m(n.mount(),n.anchor),L()),n.block=i,n.blocks&&(n.blocks[s]=i)}if((r=e)&&"object"==typeof r&&"function"==typeof r.then){if(e.then(e=>{s(n.then,1,n.value,e)},e=>{s(n.catch,2,n.error,e)}),n.current!==n.pending)return s(n.pending,0),!0}else{if(n.current!==n.then)return s(n.then,1,n.value,e),!0;n.resolved={[n.value]:e}}var r}function z(e,t,o){const{fragment:c,on_mount:u,on_destroy:i,after_update:l}=e.$$;c.m(t,o),N(()=>{const t=u.map(n).filter(r);i?i.push(...t):s(t),e.$$.on_mount=[]}),l.forEach(N)}function D(e,t){e.$$.fragment&&(s(e.$$.on_destroy),e.$$.fragment.d(t),e.$$.on_destroy=e.$$.fragment=null,e.$$.ctx={})}function B(e,t){e.$$.dirty||(_.push(e),S||(S=!0,P.then(L)),e.$$.dirty=o()),e.$$.dirty[t]=!0}function H(t,n,r,c,u,i){const l=R;y(t);const a=n.props||{},p=t.$$={fragment:null,ctx:null,props:i,update:e,not_equal:u,bound:o(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:o(),dirty:null};let d=!1;var m;p.ctx=r?r(t,a,(e,n)=>{p.ctx&&u(p.ctx[e],p.ctx[e]=n)&&(p.bound[e]&&p.bound[e](n),d&&B(t,e))}):a,p.update(),d=!0,s(p.before_update),p.fragment=c(p.ctx),n.target&&(n.hydrate?p.fragment.l((m=n.target,Array.from(m.childNodes))):p.fragment.c(),n.intro&&I(t.$$.fragment),z(t,n.target,n.anchor),L()),y(l)}class M{$destroy(){D(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}function W(t){var n,o,s,r;return{c(){n=d("li"),o=d("a"),s=m(t.name),$(o,"href",t.path),$(o,"class","svelte-kazhwj"),r=b(o,"click",g(t.redirectTo))},m(e,t){l(e,n,t),i(n,o),i(o,s)},p(e,t){e.path&&$(o,"href",t.path)},i:e,o:e,d(e){e&&a(n),r()}}}function G(e,t,n){let{selectTab:o,curRoute:s,routes:r,path:c}=t,u=window.location.origin+c,i=r[c].name;return e.$set=(e=>{"selectTab"in e&&n("selectTab",o=e.selectTab),"curRoute"in e&&n("curRoute",s=e.curRoute),"routes"in e&&n("routes",r=e.routes),"path"in e&&n("path",c=e.path)}),{selectTab:o,curRoute:s,routes:r,path:c,name:i,redirectTo:function(e){o(e.target);const t=e.target.pathname;s.set(t),window.history.pushState({path:t},"",u)}}}class Z extends M{constructor(e){super(),H(this,e,G,W,c,["selectTab","curRoute","routes","path"])}}function q(e){var t,n,o=new Z({props:{curRoute:e.curRoute,selectTab:e.selectTab,routes:e.routes,path:"/local"}}),s=new Z({props:{curRoute:e.curRoute,selectTab:e.selectTab,routes:e.routes,path:"/federated"}});return{c(){o.$$.fragment.c(),t=f(),s.$$.fragment.c()},m(e,r){z(o,e,r),l(e,t,r),z(s,e,r),n=!0},p(e,t){var n={};e.curRoute&&(n.curRoute=t.curRoute),e.selectTab&&(n.selectTab=t.selectTab),e.routes&&(n.routes=t.routes),o.$set(n);var r={};e.curRoute&&(r.curRoute=t.curRoute),e.selectTab&&(r.selectTab=t.selectTab),e.routes&&(r.routes=t.routes),s.$set(r)},i(e){n||(I(o.$$.fragment,e),I(s.$$.fragment,e),n=!0)},o(e){J(o.$$.fragment,e),J(s.$$.fragment,e),n=!1},d(e){D(o,e),e&&a(t),D(s,e)}}}function Y(e){var t,n,o,s=new Z({props:{curRoute:e.curRoute,selectTab:e.selectTab,routes:e.routes,path:"/inbox"}}),r=new Z({props:{curRoute:e.curRoute,selectTab:e.selectTab,routes:e.routes,path:"/create"}}),c=new Z({props:{curRoute:e.curRoute,selectTab:e.selectTab,routes:e.routes,path:"/search"}});return{c(){s.$$.fragment.c(),t=f(),r.$$.fragment.c(),n=f(),c.$$.fragment.c()},m(e,u){z(s,e,u),l(e,t,u),z(r,e,u),l(e,n,u),z(c,e,u),o=!0},p(e,t){var n={};e.curRoute&&(n.curRoute=t.curRoute),e.selectTab&&(n.selectTab=t.selectTab),e.routes&&(n.routes=t.routes),s.$set(n);var o={};e.curRoute&&(o.curRoute=t.curRoute),e.selectTab&&(o.selectTab=t.selectTab),e.routes&&(o.routes=t.routes),r.$set(o);var u={};e.curRoute&&(u.curRoute=t.curRoute),e.selectTab&&(u.selectTab=t.selectTab),e.routes&&(u.routes=t.routes),c.$set(u)},i(e){o||(I(s.$$.fragment,e),I(r.$$.fragment,e),I(c.$$.fragment,e),o=!0)},o(e){J(s.$$.fragment,e),J(r.$$.fragment,e),J(c.$$.fragment,e),o=!1},d(e){D(s,e),e&&a(t),D(r,e),e&&a(n),D(c,e)}}}function K(e){var t,n,o,s,r,c,u=1==e.pgi&&q(e),p=e.$session.user&&Y(e),m=new Z({props:{curRoute:e.curRoute,selectTab:e.selectTab,routes:e.routes,path:"/profile"}}),h=new Z({props:{curRoute:e.curRoute,selectTab:e.selectTab,routes:e.routes,path:"/about"}});return{c(){t=d("header"),n=d("ul"),u&&u.c(),o=f(),p&&p.c(),s=f(),m.$$.fragment.c(),r=f(),h.$$.fragment.c(),$(t,"id","navigation")},m(e,a){l(e,t,a),i(t,n),u&&u.m(n,null),i(n,o),p&&p.m(n,null),i(n,s),z(m,n,null),i(n,r),z(h,n,null),c=!0},p(e,t){1==t.pgi?u?(u.p(e,t),I(u,1)):((u=q(t)).c(),I(u,1),u.m(n,o)):u&&(U(),J(u,1,1,()=>{u=null}),E()),t.$session.user?p?(p.p(e,t),I(p,1)):((p=Y(t)).c(),I(p,1),p.m(n,s)):p&&(U(),J(p,1,1,()=>{p=null}),E());var r={};e.curRoute&&(r.curRoute=t.curRoute),e.selectTab&&(r.selectTab=t.selectTab),e.routes&&(r.routes=t.routes),m.$set(r);var c={};e.curRoute&&(c.curRoute=t.curRoute),e.selectTab&&(c.selectTab=t.selectTab),e.routes&&(c.routes=t.routes),h.$set(c)},i(e){c||(I(u),I(p),I(m.$$.fragment,e),I(h.$$.fragment,e),c=!0)},o(e){J(u),J(p),J(m.$$.fragment,e),J(h.$$.fragment,e),c=!1},d(e){e&&a(t),u&&u.d(),p&&p.d(),D(m),D(h)}}}function Q(e,t,n){let o,{routes:s,curRoute:r,selectTab:c,pgi:i,session:l}=t;return u(e,l,e=>{n("$session",o=e)}),e.$set=(e=>{"routes"in e&&n("routes",s=e.routes),"curRoute"in e&&n("curRoute",r=e.curRoute),"selectTab"in e&&n("selectTab",c=e.selectTab),"pgi"in e&&n("pgi",i=e.pgi),"session"in e&&n("session",l=e.session)}),{routes:s,curRoute:r,selectTab:c,pgi:i,session:l,$session:o}}class V extends M{constructor(e){super(),H(this,e,Q,K,c,["routes","curRoute","selectTab","pgi","session"])}}function X(t){var n,o,s;return{c(){n=d("hr"),o=f(),(s=d("footer")).innerHTML='<div class="left-column"><h3>PubGate-Philip</h3></div>',$(n,"class","separator"),$(s,"class","content")},m(e,t){l(e,n,t),l(e,o,t),l(e,s,t)},p:e,i:e,o:e,d(e){e&&(a(n),a(o),a(s))}}}class ee extends M{constructor(e){super(),H(this,e,null,X,c,[])}}function te(e,t={},n="application/activity+json"){let o={headers:{Accept:n}};return fetch(e,Object.assign(o,t)).then(e=>e.json()).catch(t=>(console.log(t),console.log("fetching"),fetch(base_url+"/proxy",{method:"POST",body:JSON.stringify({url:e})}).then(e=>e.json()).catch(e=>{console.log(e)})))}function ne(e){if("string"==typeof e){let t;return t=te(e),e=>e.object}return e}const oe=e=>({name:e,href:"",type:"Hashtag"}),se=(e,t)=>({type:"Create",object:{type:"Note",attachment:[],tag:t,content:e}});function re(t){var n,o,r,c,u,p,h,g;return{c(){n=d("form"),o=d("fieldset"),r=d("textarea"),c=f(),u=d("button"),p=m("Publish"),$(r,"class","form-control svelte-1fvj4fs"),$(r,"placeholder","Write your text here"),$(o,"class","form-group"),$(u,"class","btn btn-sm pull-xs-right btn-info"),u.disabled=h=!t.content||t.inProgress,g=[b(r,"input",t.textarea_input_handler),b(n,"submit",t.publish)]},m(e,s){l(e,n,s),i(n,o),i(o,r),r.value=t.content,i(n,c),i(n,u),i(u,p)},p(e,t){e.content&&(r.value=t.content),(e.content||e.inProgress)&&h!==(h=!t.content||t.inProgress)&&(u.disabled=h)},i:e,o:e,d(e){e&&a(n),s(g)}}}const ce=/(^|\W)(#[a-z\d][\w-]*)/gi;function ue(e,t,n){let o,{reply:s=null,session:r,curRoute:c}=t;u(e,r,e=>{n("$session",o=e)});let i=!1,l="";return e.$set=(e=>{"reply"in e&&n("reply",s=e.reply),"session"in e&&n("session",r=e.session),"curRoute"in e&&n("curRoute",c=e.curRoute)}),{reply:s,session:r,curRoute:c,inProgress:i,content:l,publish:async e=>{e.preventDefault(),n("inProgress",i=!0);let t=(e=>e.match(ce)||[])(l).map(e=>e.trim()).map(oe);const r=(e=>e.match(ce)?e.replace(ce,'$1<a href="" rel="tag">$2</a>'):e)(l);let c=se(r,t);s&&(c.object.inReplyTo=s.id,c.cc=[s.attributedTo]);try{const e=await fetch(o.user.outbox,{method:"POST",body:JSON.stringify(c),headers:{Authorization:"Bearer "+o.token}});await e.json()}catch(e){console.log(e)}n("inProgress",i=!1),n("content",l="")},textarea_input_handler:function(){l=this.value,n("content",l)}}}class ie extends M{constructor(e){super(),H(this,e,ue,re,c,["reply","session","curRoute"])}}function le(e,t,n){const o=Object.create(e);return o.attachment=t[n],o}function ae(e,t,n){const o=Object.create(e);return o.tag=t[n],o}function pe(e){var t,n;return{c(){t=d("a"),n=m(e.post),$(t,"href",e.post)},m(e,o){l(e,t,o),i(t,n)},p(e,o){e.post&&(v(n,o.post),$(t,"href",o.post))},d(e){e&&a(t)}}}function de(e){var t,n,o,s,r,c,u,p,b,g,R,y,k,x,_,w,T,j=e.post.attributedTo,P=e.post.published.replace("T"," ").replace("Z"," "),S=e.post.content;function N(e){return e.customType?fe:me}var L=N(e),O=L(e),A=e.post.tag&&he(e),C=e.post.attachment&&$e(e);return{c(){t=d("div"),n=d("a"),O.c(),s=m("\n    by user\n    "),r=d("a"),c=m(j),p=f(),(b=d("span")).textContent="·",g=f(),R=d("span"),y=m(P),k=f(),A&&A.c(),x=f(),_=d("p"),w=f(),C&&C.c(),T=h(),$(n,"href",o=e.post.id),$(r,"href",u=e.post.attributedTo),$(b,"class","metadata-seperator"),$(t,"class","metadata")},m(e,o){l(e,t,o),i(t,n),O.m(n,null),i(t,s),i(t,r),i(r,c),i(t,p),i(t,b),i(t,g),i(t,R),i(R,y),l(e,k,o),A&&A.m(e,o),l(e,x,o),l(e,_,o),_.innerHTML=S,l(e,w,o),C&&C.m(e,o),l(e,T,o)},p(e,t){L===(L=N(t))&&O?O.p(e,t):(O.d(1),(O=L(t))&&(O.c(),O.m(n,null))),e.post&&o!==(o=t.post.id)&&$(n,"href",o),e.post&&j!==(j=t.post.attributedTo)&&v(c,j),e.post&&u!==(u=t.post.attributedTo)&&$(r,"href",u),e.post&&P!==(P=t.post.published.replace("T"," ").replace("Z"," "))&&v(y,P),t.post.tag?A?A.p(e,t):((A=he(t)).c(),A.m(x.parentNode,x)):A&&(A.d(1),A=null),e.post&&S!==(S=t.post.content)&&(_.innerHTML=S),t.post.attachment?C?C.p(e,t):((C=$e(t)).c(),C.m(T.parentNode,T)):C&&(C.d(1),C=null)},d(e){e&&a(t),O.d(),e&&a(k),A&&A.d(e),e&&(a(x),a(_),a(w)),C&&C.d(e),e&&a(T)}}}function me(e){var t,n=e.post.type;return{c(){t=m(n)},m(e,n){l(e,t,n)},p(e,o){e.post&&n!==(n=o.post.type)&&v(t,n)},d(e){e&&a(t)}}}function fe(e){var t;return{c(){t=m(e.customType)},m(e,n){l(e,t,n)},p(e,n){e.customType&&v(t,n.customType)},d(e){e&&a(t)}}}function he(e){for(var t,n=e.post.tag,o=[],s=0;s<n.length;s+=1)o[s]=ge(ae(e,n,s));return{c(){t=d("div");for(var e=0;e<o.length;e+=1)o[e].c();$(t,"class","tags")},m(e,n){l(e,t,n);for(var s=0;s<o.length;s+=1)o[s].m(t,null)},p(e,s){if(e.post){n=s.post.tag;for(var r=0;r<n.length;r+=1){const c=ae(s,n,r);o[r]?o[r].p(e,c):(o[r]=ge(c),o[r].c(),o[r].m(t,null))}for(;r<o.length;r+=1)o[r].d(1);o.length=n.length}},d(e){e&&a(t),p(o,e)}}}function be(e){var t,n,o,s=e.tag.name;return{c(){t=d("a"),n=m(s),$(t,"class","tag"),$(t,"href",o=e.tag.href)},m(e,o){l(e,t,o),i(t,n)},p(e,r){e.post&&s!==(s=r.tag.name)&&v(n,s),e.post&&o!==(o=r.tag.href)&&$(t,"href",o)},d(e){e&&a(t)}}}function ge(e){var t,n="Hashtag"==e.tag.type&&be(e);return{c(){n&&n.c(),t=h()},m(e,o){n&&n.m(e,o),l(e,t,o)},p(e,o){"Hashtag"==o.tag.type?n?n.p(e,o):((n=be(o)).c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&a(t)}}}function $e(e){for(var t,n=e.post.attachment,o=[],s=0;s<n.length;s+=1)o[s]=Re(le(e,n,s));return{c(){for(var e=0;e<o.length;e+=1)o[e].c();t=h()},m(e,n){for(var s=0;s<o.length;s+=1)o[s].m(e,n);l(e,t,n)},p(e,s){if(e.post){n=s.post.attachment;for(var r=0;r<n.length;r+=1){const c=le(s,n,r);o[r]?o[r].p(e,c):(o[r]=Re(c),o[r].c(),o[r].m(t.parentNode,t))}for(;r<o.length;r+=1)o[r].d(1);o.length=n.length}},d(e){p(o,e),e&&a(t)}}}function ve(e){var t,n;return{c(){$(t=d("img"),"src",n=e.attachment.url),$(t,"alt","image")},m(e,n){l(e,t,n)},p(e,o){e.post&&n!==(n=o.attachment.url)&&$(t,"src",n)},d(e){e&&a(t)}}}function Re(e){var t,n="Document"===e.attachment.type&&e.attachment.mediaType.startsWith("image")&&ve(e);return{c(){n&&n.c(),t=h()},m(e,o){n&&n.m(e,o),l(e,t,o)},p(e,o){"Document"===o.attachment.type&&o.attachment.mediaType.startsWith("image")?n?n.p(e,o):((n=ve(o)).c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&a(t)}}}function ye(t){var n;function o(e){return e.post.id?de:pe}var s=o(t),r=s(t);return{c(){r.c(),n=h()},m(e,t){r.m(e,t),l(e,n,t)},p(e,t){s===(s=o(t))&&r?r.p(e,t):(r.d(1),(r=s(t))&&(r.c(),r.m(n.parentNode,n)))},i:e,o:e,d(e){r.d(e),e&&a(n)}}}function ke(e,t,n){let{post:o,customType:s=null}=t;return e.$set=(e=>{"post"in e&&n("post",o=e.post),"customType"in e&&n("customType",s=e.customType)}),{post:o,customType:s}}class xe extends M{constructor(e){super(),H(this,e,ke,ye,c,["post","customType"])}}function _e(e){var t,n,o,s,r=[Te,we],c=[];function u(e){return"object"==typeof e.inReply&&"string"!=typeof e.inReply.id?0:1}return n=u(e),o=c[n]=r[n](e),{c(){t=d("div"),o.c(),$(t,"class","reaction svelte-ni4kye")},m(e,o){l(e,t,o),c[n].m(t,null),s=!0},p(e,s){var i=n;(n=u(s))===i?c[n].p(e,s):(U(),J(c[i],1,1,()=>{c[i]=null}),E(),(o=c[n])||(o=c[n]=r[n](s)).c(),I(o,1),o.m(t,null))},i(e){s||(I(o),s=!0)},o(e){J(o),s=!1},d(e){e&&a(t),c[n].d()}}}function we(e){var t,n=new xe({props:{post:e.inReply}});return{c(){n.$$.fragment.c()},m(e,o){z(n,e,o),t=!0},p(e,t){var o={};e.inReply&&(o.post=t.inReply),n.$set(o)},i(e){t||(I(n.$$.fragment,e),t=!0)},o(e){J(n.$$.fragment,e),t=!1},d(e){D(n,e)}}}function Te(e){var n,o,s;let r={ctx:e,current:null,token:null,pending:Se,then:Pe,catch:je,value:"value",error:"null",blocks:[,,,]};return F(o=e.inReply,r),{c(){n=h(),r.block.c()},m(e,t){l(e,n,t),r.block.m(e,r.anchor=t),r.mount=(()=>n.parentNode),r.anchor=n,s=!0},p(n,s){e=s,r.ctx=e,"inReply"in n&&o!==(o=e.inReply)&&F(o,r)||r.block.p(n,t(t({},e),r.resolved))},i(e){s||(I(r.block),s=!0)},o(e){for(let e=0;e<3;e+=1){J(r.blocks[e])}s=!1},d(e){e&&a(n),r.block.d(e),r.token=null,r=null}}}function je(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function Pe(e){var t,n=new xe({props:{post:e.value}});return{c(){n.$$.fragment.c()},m(e,o){z(n,e,o),t=!0},p(e,t){var o={};e.inReply&&(o.post=t.value),n.$set(o)},i(e){t||(I(n.$$.fragment,e),t=!0)},o(e){J(n.$$.fragment,e),t=!1},d(e){D(n,e)}}}function Se(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function Ne(e){var t,n,o,r,c,u,p,g,v,R,y,k,x=e.liked&&Le(),_=e.announced&&Oe(),w=e.showPublish&&Ae(e);return{c(){t=d("div"),n=d("button"),o=m("Like"),x&&x.c(),r=f(),(c=d("button")).textContent="Add comment",u=f(),p=d("button"),g=m("Announce"),_&&_.c(),v=f(),w&&w.c(),R=h(),$(n,"class","ra_item svelte-ni4kye"),$(c,"class","ra_item svelte-ni4kye"),$(p,"class","ra_item svelte-ni4kye"),$(t,"class","ra svelte-ni4kye"),k=[b(c,"click",e.togglePublish),b(p,"click",e.doAnnounce)]},m(e,s){l(e,t,s),i(t,n),i(n,o),x&&x.m(n,null),i(t,r),i(t,c),i(t,u),i(t,p),i(p,g),_&&_.m(p,null),l(e,v,s),w&&w.m(e,s),l(e,R,s),y=!0},p(e,t){t.liked?x||((x=Le()).c(),x.m(n,null)):x&&(x.d(1),x=null),t.announced?_||((_=Oe()).c(),_.m(p,null)):_&&(_.d(1),_=null),t.showPublish?w?(w.p(e,t),I(w,1)):((w=Ae(t)).c(),I(w,1),w.m(R.parentNode,R)):w&&(U(),J(w,1,1,()=>{w=null}),E())},i(e){y||(I(w),y=!0)},o(e){J(w),y=!1},d(e){e&&a(t),x&&x.d(),_&&_.d(),e&&a(v),w&&w.d(e),e&&a(R),s(k)}}}function Le(e){var t;return{c(){t=m("d")},m(e,n){l(e,t,n)},d(e){e&&a(t)}}}function Oe(e){var t;return{c(){t=m("d")},m(e,n){l(e,t,n)},d(e){e&&a(t)}}}function Ae(e){var t,n=new ie({props:{reply:e.post,session:e.session}});return{c(){n.$$.fragment.c()},m(e,o){z(n,e,o),t=!0},p(e,t){var o={};e.post&&(o.reply=t.post),e.session&&(o.session=t.session),n.$set(o)},i(e){t||(I(n.$$.fragment,e),t=!0)},o(e){J(n.$$.fragment,e),t=!1},d(e){D(n,e)}}}function Ce(e){var t,n,o,r,c,u,p,h,g,R,y,k,x,_,w,T,j,P,S=1==e.isReply&&_e(e),N=new xe({props:{post:e.post,customType:e.customType}}),L=e.$session.user&&Ne(e);return{c(){S&&S.c(),t=f(),N.$$.fragment.c(),n=f(),o=d("div"),r=d("div"),c=d("span"),u=m(e.likes),p=m(" likes"),h=f(),g=d("span"),R=m(e.comments),y=m(" comments"),k=f(),x=d("span"),_=m(e.announces),w=m(" announces"),T=f(),L&&L.c(),$(c,"class","rs_left svelte-ni4kye"),$(g,"class","rs_right svelte-ni4kye"),$(x,"class","rs_right svelte-ni4kye"),$(r,"class","rs svelte-ni4kye"),$(o,"class","reactionz svelte-ni4kye"),P=[b(c,"click",e.toggleLists),b(g,"click",e.toggleLists),b(x,"click",e.toggleLists)]},m(e,s){S&&S.m(e,s),l(e,t,s),z(N,e,s),l(e,n,s),l(e,o,s),i(o,r),i(r,c),i(c,u),i(c,p),i(r,h),i(r,g),i(g,R),i(g,y),i(r,k),i(r,x),i(x,_),i(x,w),i(o,T),L&&L.m(o,null),j=!0},p(e,n){1==n.isReply?S?(S.p(e,n),I(S,1)):((S=_e(n)).c(),I(S,1),S.m(t.parentNode,t)):S&&(U(),J(S,1,1,()=>{S=null}),E());var s={};e.post&&(s.post=n.post),e.customType&&(s.customType=n.customType),N.$set(s),j&&!e.likes||v(u,n.likes),j&&!e.comments||v(R,n.comments),j&&!e.announces||v(_,n.announces),n.$session.user?L?(L.p(e,n),I(L,1)):((L=Ne(n)).c(),I(L,1),L.m(o,null)):L&&(U(),J(L,1,1,()=>{L=null}),E())},i(e){j||(I(S),I(N.$$.fragment,e),I(L),j=!0)},o(e){J(S),J(N.$$.fragment,e),J(L),j=!1},d(e){S&&S.d(e),e&&a(t),D(N,e),e&&(a(n),a(o)),L&&L.d(),s(P)}}}function Ue(e,t,n){let o,{post:s,session:r}=t;u(e,r,e=>{n("$session",o=e)});let c=pubgate_instance,i=!1;let l,a,p;o.user&&(s.reactions&&s.reactions.Like&&s.reactions.Like[o.user.name]&&n("liked",l=!0),s.reactions&&s.reactions.Announce&&s.reactions.Announce[o.user.name]&&n("announced",a=!0));let d=!1,m="n/a",f="n/a",h="n/a";s.inReplyTo&&(n("inReply",p=c?s.inReplyTo:ne(s.inReplyTo)),n("isReply",d=!0)),s.likes&&n("likes",m=s.likes.totalItems),s.shares&&n("announces",h=s.shares.totalItems),s.replies&&n("comments",f=s.replies.totalItems);let b=d?"Reply":null;return e.$set=(e=>{"post"in e&&n("post",s=e.post),"session"in e&&n("session",r=e.session)}),{post:s,session:r,showPublish:i,togglePublish:e=>{e.preventDefault(),n("showPublish",i=!i)},toggleLists:e=>{e.preventDefault()},liked:l,announced:a,inReply:p,isReply:d,likes:m,comments:f,announces:h,customType:b,doAnnounce:async function(e){if(e.preventDefault(),!a){let e={type:"Announce",object:s.id,cc:[s.attributedTo]};await fetch(o.user.outbox,{method:"POST",body:JSON.stringify(e),headers:{Authorization:"Bearer "+o.token}}).then(e=>e.json()),n("announced",a=!0)}},$session:o}}class Ee extends M{constructor(e){super(),H(this,e,Ue,Ce,c,["post","session"])}}function Ie(e){var t,n,o,s,r,c,u,p,h,b,g,R,y,k,x,_,w=e.post.type,T=e.post.actor,j=e.post.published&&Fe(e),P=new Ee({props:{post:e.postObject,session:e.session}});return{c(){t=d("div"),(n=d("h2")).textContent=".",o=f(),s=d("a"),r=m(w),u=m("\n      by user\n      "),p=d("a"),h=m(T),g=f(),(R=d("span")).textContent="·",y=f(),j&&j.c(),k=f(),x=d("div"),P.$$.fragment.c(),$(n,"id",""),$(s,"href",c=e.post.id),$(p,"href",b=e.post.actor),$(R,"class","metadata-seperator"),$(t,"class","metadata"),$(x,"class","reaction svelte-fh8bnq")},m(e,c){l(e,t,c),i(t,n),i(t,o),i(t,s),i(s,r),i(t,u),i(t,p),i(p,h),i(t,g),i(t,R),i(t,y),j&&j.m(t,null),l(e,k,c),l(e,x,c),z(P,x,null),_=!0},p(e,n){_&&!e.post||w===(w=n.post.type)||v(r,w),_&&!e.post||c===(c=n.post.id)||$(s,"href",c),_&&!e.post||T===(T=n.post.actor)||v(h,T),_&&!e.post||b===(b=n.post.actor)||$(p,"href",b),n.post.published?j?j.p(e,n):((j=Fe(n)).c(),j.m(t,null)):j&&(j.d(1),j=null);var o={};e.postObject&&(o.post=n.postObject),e.session&&(o.session=n.session),P.$set(o)},i(e){_||(I(P.$$.fragment,e),_=!0)},o(e){J(P.$$.fragment,e),_=!1},d(e){e&&a(t),j&&j.d(),e&&(a(k),a(x)),D(P)}}}function Je(e){var t,n,o,s=new Ee({props:{post:e.post.object,session:e.session}});return{c(){(t=d("h2")).textContent=".",n=f(),s.$$.fragment.c(),$(t,"id","")},m(e,r){l(e,t,r),l(e,n,r),z(s,e,r),o=!0},p(e,t){var n={};e.post&&(n.post=t.post.object),e.session&&(n.session=t.session),s.$set(n)},i(e){o||(I(s.$$.fragment,e),o=!0)},o(e){J(s.$$.fragment,e),o=!1},d(e){e&&(a(t),a(n)),D(s,e)}}}function Fe(e){var t,n,o=e.post.published.replace("T"," ").replace("Z"," ");return{c(){t=d("span"),n=m(o)},m(e,o){l(e,t,o),i(t,n)},p(e,t){e.post&&o!==(o=t.post.published.replace("T"," ").replace("Z"," "))&&v(n,o)},d(e){e&&a(t)}}}function ze(e){var t,n,o,s,r=[Je,Ie],c=[];function u(e){return 0==e.isReaction?0:1}return n=u(e),o=c[n]=r[n](e),{c(){t=d("li"),o.c(),$(t,"class","post")},m(e,o){l(e,t,o),c[n].m(t,null),s=!0},p(e,s){var i=n;(n=u(s))===i?c[n].p(e,s):(U(),J(c[i],1,1,()=>{c[i]=null}),E(),(o=c[n])||(o=c[n]=r[n](s)).c(),I(o,1),o.m(t,null))},i(e){s||(I(o),s=!0)},o(e){J(o),s=!1},d(e){e&&a(t),c[n].d()}}}function De(e,t,n){let o,{post:s,session:r}=t,c=pubgate_instance,u=!1;return["Announce","Like"].includes(s.type)&&(n("postObject",o=c?s.object:ne(s.object)),n("isReaction",u=!0)),e.$set=(e=>{"post"in e&&n("post",s=e.post),"session"in e&&n("session",r=e.session)}),{post:s,session:r,postObject:o,isReaction:u}}class Be extends M{constructor(e){super(),H(this,e,De,ze,c,["post","session"])}}function He(e,t,n){const o=Object.create(e);return o.post=t[n],o}function Me(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function We(e){for(var t,n,o,s,r,c,u,m=e.value,h=[],b=0;b<m.length;b+=1)h[b]=Ge(He(e,m,b));const g=e=>J(h[e],1,1,()=>{h[e]=null});var v=e.homeUrl&&Ze(e),R=e.prevUrl&&qe(e),y=e.page&&Ye(e),k=e.nextUrl&&Ke(e);return{c(){t=d("ul");for(var e=0;e<h.length;e+=1)h[e].c();n=f(),o=d("div"),v&&v.c(),s=f(),R&&R.c(),r=f(),y&&y.c(),c=f(),k&&k.c(),$(t,"class","post-list"),$(o,"class","navigation svelte-1crpel7")},m(e,a){l(e,t,a);for(var p=0;p<h.length;p+=1)h[p].m(t,null);l(e,n,a),l(e,o,a),v&&v.m(o,null),i(o,s),R&&R.m(o,null),i(o,r),y&&y.m(o,null),i(o,c),k&&k.m(o,null),u=!0},p(e,n){if(e.posts||e.session){m=n.value;for(var u=0;u<m.length;u+=1){const o=He(n,m,u);h[u]?(h[u].p(e,o),I(h[u],1)):(h[u]=Ge(o),h[u].c(),I(h[u],1),h[u].m(t,null))}for(U(),u=m.length;u<h.length;u+=1)g(u);E()}n.homeUrl?v||((v=Ze(n)).c(),v.m(o,s)):v&&(v.d(1),v=null),n.prevUrl?R||((R=qe(n)).c(),R.m(o,r)):R&&(R.d(1),R=null),n.page?y?y.p(e,n):((y=Ye(n)).c(),y.m(o,c)):y&&(y.d(1),y=null),n.nextUrl?k||((k=Ke(n)).c(),k.m(o,null)):k&&(k.d(1),k=null)},i(e){if(!u){for(var t=0;t<m.length;t+=1)I(h[t]);u=!0}},o(e){h=h.filter(Boolean);for(let e=0;e<h.length;e+=1)J(h[e]);u=!1},d(e){e&&a(t),p(h,e),e&&(a(n),a(o)),v&&v.d(),R&&R.d(),y&&y.d(),k&&k.d()}}}function Ge(e){var t,n=new Be({props:{post:e.post,session:e.session}});return{c(){n.$$.fragment.c()},m(e,o){z(n,e,o),t=!0},p(e,t){var o={};e.posts&&(o.post=t.post),e.session&&(o.session=t.session),n.$set(o)},i(e){t||(I(n.$$.fragment,e),t=!0)},o(e){J(n.$$.fragment,e),t=!1},d(e){D(n,e)}}}function Ze(e){var t,n;return{c(){(t=d("span")).textContent="First",n=b(t,"click",e.click_handler)},m(e,n){l(e,t,n)},d(e){e&&a(t),n()}}}function qe(e){var t,n;return{c(){(t=d("span")).textContent="Previous",n=b(t,"click",e.click_handler_1)},m(e,n){l(e,t,n)},d(e){e&&a(t),n()}}}function Ye(e){var t,n;return{c(){t=d("b"),n=m(e.page)},m(e,o){l(e,t,o),i(t,n)},p(e,t){e.page&&v(n,t.page)},d(e){e&&a(t)}}}function Ke(e){var t,n;return{c(){(t=d("span")).textContent="Next",n=b(t,"click",e.click_handler_2)},m(e,n){l(e,t,n)},d(e){e&&a(t),n()}}}function Qe(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function Ve(e){var n,o,s;let r={ctx:e,current:null,token:null,pending:Qe,then:We,catch:Me,value:"value",error:"null",blocks:[,,,]};return F(o=e.posts,r),{c(){n=h(),r.block.c()},m(e,t){l(e,n,t),r.block.m(e,r.anchor=t),r.mount=(()=>n.parentNode),r.anchor=n,s=!0},p(n,s){e=s,r.ctx=e,"posts"in n&&o!==(o=e.posts)&&F(o,r)||r.block.p(n,t(t({},e),r.resolved))},i(e){s||(I(r.block),s=!0)},o(e){for(let e=0;e<3;e+=1){J(r.blocks[e])}s=!1},d(e){e&&a(n),r.block.d(e),r.token=null,r=null}}}function Xe(e,t,n){let o,s,{curRoute:r}=t;u(e,r,e=>{n("$curRoute",o=e)});let{session:c,outbox_collection:i={}}=t;u(e,c,e=>{n("$session",s=e)});let l=pubgate_instance;const a=function(e,t={},n=!1){let o={Accept:"application/activity+json"};return t.user&&n&&(o.Authorization="Bearer "+t.token),fetch(e,{headers:o}).then(e=>e.json()).then(e=>b(e))};let p,d,m,f;const h=e=>{let t=e.split("?"),o=t.shift();l&&t.push("cached=1"),n("posts",g=a(o+"?"+t.join("&"),c))},b=e=>{let t=/page=(\d+)$/.exec(e.id);return n("page",f=t?parseInt(t[1]):1),n("homeUrl",p=f>1&&e.partOf?e.partOf:null),n("prevUrl",d=f>1?`${p}?page=${f-1}`:null),n("nextUrl",m=e.next),e.first?e.first.orderedItems:e.orderedItems};let g;return e.$set=(e=>{"curRoute"in e&&n("curRoute",r=e.curRoute),"session"in e&&n("session",c=e.session),"outbox_collection"in e&&n("outbox_collection",i=e.outbox_collection)}),e.$$.update=((e={$curRoute:1,$session:1})=>{(e.$curRoute||e.$session)&&n("posts",g=function(e,t){switch(e){case"/local":return l?a(base_url+"/timeline/local?cached=1"):[];case"/federated":return l?a(base_url+"/timeline/federated?cached=1"):[];case"/inbox":return t.user?l?a(t.user.inbox+"?cached=1",t,!0):a(t.user.inbox,t):[];case"/profile":return a(l?t.user.outbox+"?cached=1":t.user.outbox);case"/search":return i.orderedItems;default:return[]}}(o,s))}),{curRoute:r,session:c,outbox_collection:i,homeUrl:p,prevUrl:d,nextUrl:m,page:f,selectPage:h,posts:g,click_handler:function(){return h(p)},click_handler_1:function(){return h(d)},click_handler_2:function(){return h(m)}}}class et extends M{constructor(e){super(),H(this,e,Xe,Ve,c,["curRoute","session","outbox_collection"])}}const tt=[];function nt(e,t){return{subscribe:ot(e,t).subscribe}}function ot(t,n=e){let o;const s=[];function r(e){if(c(t,e)&&(t=e,o)){const e=!tt.length;for(let e=0;e<s.length;e+=1){const n=s[e];n[1](),tt.push(n,t)}if(e){for(let e=0;e<tt.length;e+=2)tt[e][0](tt[e+1]);tt.length=0}}}return{set:r,update:function(e){r(e(t))},subscribe:function(c,u=e){const i=[c,u];return s.push(i),1===s.length&&(o=n(r)||e),c(t),()=>{const e=s.indexOf(i);-1!==e&&s.splice(e,1),0===s.length&&(o(),o=null)}}}}function st(e){var t,n,o,s,r,c=e.$session.user&&rt(e),u=new et({props:{curRoute:e.timelineRoute,session:e.session,outbox_collection:e.outbox_collection}});return{c(){t=d("h2"),n=m(e.username),o=f(),c&&c.c(),s=f(),u.$$.fragment.c()},m(e,a){l(e,t,a),i(t,n),i(t,o),c&&c.m(t,null),l(e,s,a),z(u,e,a),r=!0},p(e,o){r&&!e.username||v(n,o.username),o.$session.user?c||((c=rt(o)).c(),c.m(t,null)):c&&(c.d(1),c=null);var s={};e.timelineRoute&&(s.curRoute=o.timelineRoute),e.session&&(s.session=o.session),e.outbox_collection&&(s.outbox_collection=o.outbox_collection),u.$set(s)},i(e){r||(I(u.$$.fragment,e),r=!0)},o(e){J(u.$$.fragment,e),r=!1},d(e){e&&a(t),c&&c.d(),e&&a(s),D(u,e)}}}function rt(e){var t,n;return{c(){(t=d("button")).textContent="Follow",$(t,"class","btn btn-sm pull-xs-right btn-info"),n=b(t,"click",e.follow)},m(e,n){l(e,t,n)},d(e){e&&a(t),n()}}}function ct(e){var t,n=new Ee({props:{post:e.loadedPost,session:e.session}});return{c(){n.$$.fragment.c()},m(e,o){z(n,e,o),t=!0},p(e,t){var o={};e.loadedPost&&(o.post=t.loadedPost),e.session&&(o.session=t.session),n.$set(o)},i(e){t||(I(n.$$.fragment,e),t=!0)},o(e){J(n.$$.fragment,e),t=!1},d(e){D(n,e)}}}function ut(e){var t,n,o,r,c,u,p,h,R,y,k,x,_,w,T,j,P,S,N,L,O,A,C,F,z,D,B,H,M,W,G,Z,q=e.outbox_collection&&st(e),Y="object"==typeof e.loadedPost&&ct(e);return{c(){t=d("br"),n=m("\nSearch accounts\n"),o=d("form"),r=d("fieldset"),c=d("input"),u=f(),p=d("button"),h=m("Search user"),y=f(),k=d("br"),x=f(),_=d("br"),w=m("\nLoad Post by link\n"),T=d("form"),j=d("fieldset"),P=d("input"),S=f(),N=d("button"),L=m("Load post"),A=f(),C=d("br"),F=f(),z=d("br"),D=f(),q&&q.c(),B=f(),Y&&Y.c(),H=f(),M=d("p"),W=m(e.error),$(c,"class","form-control form-control-lg"),$(c,"type","text"),$(c,"placeholder","Search format: username@domain"),$(r,"class","form-group"),$(p,"class","btn btn-sm pull-xs-right btn-info"),$(p,"type","submit"),p.disabled=R=!e.username,$(P,"class","form-control form-control-lg"),$(P,"type","text"),$(P,"placeholder","Copy a link here"),$(j,"class","form-group"),$(N,"class","btn btn-sm pull-xs-right btn-info"),$(N,"type","submit"),N.disabled=O=!e.postLink,$(M,"class","text-danger"),Z=[b(c,"input",e.input0_input_handler),b(o,"submit",g(e.search)),b(P,"input",e.input1_input_handler),b(T,"submit",g(e.loadPost))]},m(s,a){l(s,t,a),l(s,n,a),l(s,o,a),i(o,r),i(r,c),c.value=e.username,i(o,u),i(o,p),i(p,h),l(s,y,a),l(s,k,a),l(s,x,a),l(s,_,a),l(s,w,a),l(s,T,a),i(T,j),i(j,P),P.value=e.postLink,i(T,S),i(T,N),i(N,L),l(s,A,a),l(s,C,a),l(s,F,a),l(s,z,a),l(s,D,a),q&&q.m(s,a),l(s,B,a),Y&&Y.m(s,a),l(s,H,a),l(s,M,a),i(M,W),G=!0},p(e,t){e.username&&c.value!==t.username&&(c.value=t.username),G&&!e.username||R===(R=!t.username)||(p.disabled=R),e.postLink&&P.value!==t.postLink&&(P.value=t.postLink),G&&!e.postLink||O===(O=!t.postLink)||(N.disabled=O),t.outbox_collection?q?(q.p(e,t),I(q,1)):((q=st(t)).c(),I(q,1),q.m(B.parentNode,B)):q&&(U(),J(q,1,1,()=>{q=null}),E()),"object"==typeof t.loadedPost?Y?(Y.p(e,t),I(Y,1)):((Y=ct(t)).c(),I(Y,1),Y.m(H.parentNode,H)):Y&&(U(),J(Y,1,1,()=>{Y=null}),E()),G&&!e.error||v(W,t.error)},i(e){G||(I(q),I(Y),G=!0)},o(e){J(q),J(Y),G=!1},d(e){e&&(a(t),a(n),a(o),a(y),a(k),a(x),a(_),a(w),a(T),a(A),a(C),a(F),a(z),a(D)),q&&q.d(e),e&&a(B),Y&&Y.d(e),e&&(a(H),a(M)),s(Z)}}}function it(e,t,n){let o,{session:s,curRoute:r}=t;u(e,s,e=>{n("$session",o=e)});const c=nt("/search");let i="",l=null,a=null,p="",d="",m="";return e.$set=(e=>{"session"in e&&n("session",s=e.session),"curRoute"in e&&n("curRoute",r=e.curRoute)}),{session:s,curRoute:r,timelineRoute:c,username:i,outbox_collection:l,loadedPost:p,postLink:d,error:m,search:async function(e){n("outbox_collection",l=null);let t,o=i.split("@"),s="https://"+o[1]+"/@"+o[0];if(pubgate_instance){const e=await fetch(base_url+"/proxy",{method:"POST",body:JSON.stringify({url:s})}).then(e=>e.json());a=e;const o=await fetch(base_url+"/proxy",{method:"POST",body:JSON.stringify({url:e.outbox})}).then(e=>e.json());t="string"==typeof o.first?await fetch(base_url+"/proxy",{method:"POST",body:JSON.stringify({url:o.first})}).then(e=>e.json()):o.first,n("outbox_collection",l=t)}else{const e=await fetch(s,{headers:{Accept:"application/activity+json"}}).then(e=>e.json());e.outbox&&n("outbox_collection",l=e.outbox)}},follow:async function(e){if(pubgate_instance){let e={type:"Follow",object:a.id};await fetch(o.user.outbox,{method:"POST",body:JSON.stringify(e),headers:{Authorization:"Bearer "+o.token}}).then(e=>e.json())}},loadPost:async function(e){n("error",m=p=""),n("loadedPost",p);try{const e=await te(d),{type:t}=e;if("Note"!==t)return void n("error",m=`Wrong type: ${t}`);n("loadedPost",p=e),n("postLink",d="")}catch(e){n("error",m=e.message)}},$session:o,input0_input_handler:function(){i=this.value,n("username",i)},input1_input_handler:function(){d=this.value,n("postLink",d)}}}function lt(t){var n,o,r,c,u,p,h,R,y,k,x,_,w,T,j,P,S,N,L,O,A,C,U,E,I,J,F,z,D,B,H,M,W,G,Z,q,Y,K,Q,V,X,ee;return{c(){(n=d("div")).textContent="Sign-in ( ActivityPub compatible, OAuth2 password grant )",o=f(),r=d("form"),c=d("fieldset"),u=d("input"),p=f(),h=d("fieldset"),R=d("input"),y=f(),k=d("button"),x=m("Sign in"),w=f(),T=d("br"),j=f(),P=d("div"),S=m(t.error),N=f(),L=d("br"),O=m("\n  or register ( PubGate only )\n  "),A=d("br"),C=f(),U=d("form"),E=d("fieldset"),I=d("input"),J=f(),F=d("fieldset"),z=d("input"),D=f(),B=d("fieldset"),H=d("textarea"),M=f(),W=d("fieldset"),G=d("input"),Z=f(),q=d("fieldset"),Y=d("input"),K=f(),Q=d("button"),V=m("Register"),$(n,"class","form-group"),$(u,"class","form-control form-control-lg"),$(u,"type","username"),$(u,"placeholder","Username"),$(c,"class","form-group"),$(R,"class","form-control form-control-lg"),$(R,"type","password"),$(R,"placeholder","Password"),$(h,"class","form-group"),$(k,"class","btn btn-sm pull-xs-right btn-info"),$(k,"type","submit"),k.disabled=_=!t.username||!t.password,$(P,"class","text-danger"),$(I,"class","form-control form-control-lg"),$(I,"type","text"),$(I,"placeholder","Username"),$(E,"class","form-group"),$(z,"class","form-control form-control-lg"),$(z,"type","password"),$(z,"placeholder","Password"),$(F,"class","form-group"),$(H,"class","form-control"),$(H,"rows","8"),$(H,"placeholder","Profile Description"),$(B,"class","form-group"),$(G,"class","form-control form-control-lg"),$(G,"type","text"),$(G,"placeholder","Avatar URL"),$(W,"class","form-group"),$(Y,"class","form-control form-control-lg"),$(Y,"type","text"),$(Y,"placeholder","Invite code"),$(q,"class","form-group"),$(Q,"class","btn btn-sm pull-xs-right btn-info"),$(Q,"type","submit"),Q.disabled=X=!t.username||!t.password,ee=[b(u,"input",t.input0_input_handler),b(R,"input",t.input1_input_handler),b(r,"submit",g(t.login)),b(I,"input",t.input2_input_handler),b(z,"input",t.input3_input_handler),b(H,"input",t.textarea_input_handler),b(G,"input",t.input4_input_handler),b(Y,"input",t.input5_input_handler),b(U,"submit",g(t.register))]},m(e,s){l(e,n,s),l(e,o,s),l(e,r,s),i(r,c),i(c,u),u.value=t.username,i(r,p),i(r,h),i(h,R),R.value=t.password,i(r,y),i(r,k),i(k,x),l(e,w,s),l(e,T,s),l(e,j,s),l(e,P,s),i(P,S),l(e,N,s),l(e,L,s),l(e,O,s),l(e,A,s),l(e,C,s),l(e,U,s),i(U,E),i(E,I),I.value=t.username,i(U,J),i(U,F),i(F,z),z.value=t.password,i(U,D),i(U,B),i(B,H),H.value=t.description,i(U,M),i(U,W),i(W,G),G.value=t.avatar,i(U,Z),i(U,q),i(q,Y),Y.value=t.invite,i(U,K),i(U,Q),i(Q,V)},p(e,t){e.username&&(u.value=t.username),e.password&&R.value!==t.password&&(R.value=t.password),(e.username||e.password)&&_!==(_=!t.username||!t.password)&&(k.disabled=_),e.error&&v(S,t.error),e.username&&I.value!==t.username&&(I.value=t.username),e.password&&z.value!==t.password&&(z.value=t.password),e.description&&(H.value=t.description),e.avatar&&G.value!==t.avatar&&(G.value=t.avatar),e.invite&&Y.value!==t.invite&&(Y.value=t.invite),(e.username||e.password)&&X!==(X=!t.username||!t.password)&&(Q.disabled=X)},i:e,o:e,d(e){e&&(a(n),a(o),a(r),a(w),a(T),a(j),a(P),a(N),a(L),a(O),a(A),a(C),a(U)),s(ee)}}}function at(e){var t,n,o,s,r,c,u,p,h,g,R,y=e.$session.user.name,k=e.$session.user.summary,x=new et({props:{curRoute:e.curRoute,session:e.session}});return{c(){t=d("h2"),n=d("a"),o=m(y),r=f(),(c=d("button")).textContent="Logout",u=f(),p=m(k),h=f(),x.$$.fragment.c(),$(n,"href",s=e.$session.user.url),$(c,"class","btn btn-sm pull-xs-right btn-info"),R=b(c,"click",e.logout)},m(e,s){l(e,t,s),i(t,n),i(n,o),i(t,r),i(t,c),l(e,u,s),l(e,p,s),l(e,h,s),z(x,e,s),g=!0},p(e,t){g&&!e.$session||y===(y=t.$session.user.name)||v(o,y),g&&!e.$session||s===(s=t.$session.user.url)||$(n,"href",s),g&&!e.$session||k===(k=t.$session.user.summary)||v(p,k);var r={};e.curRoute&&(r.curRoute=t.curRoute),e.session&&(r.session=t.session),x.$set(r)},i(e){g||(I(x.$$.fragment,e),g=!0)},o(e){J(x.$$.fragment,e),g=!1},d(e){e&&(a(t),a(u),a(p),a(h)),D(x,e),R()}}}function pt(e){var t,n,o,s,r=[at,lt],c=[];function u(e){return e.$session.user?0:1}return t=u(e),n=c[t]=r[t](e),{c(){n.c(),o=h()},m(e,n){c[t].m(e,n),l(e,o,n),s=!0},p(e,s){var i=t;(t=u(s))===i?c[t].p(e,s):(U(),J(c[i],1,1,()=>{c[i]=null}),E(),(n=c[t])||(n=c[t]=r[t](s)).c(),I(n,1),n.m(o.parentNode,o))},i(e){s||(I(n),s=!0)},o(e){J(n),s=!1},d(e){c[t].d(e),e&&a(o)}}}function dt(e,t,n){let o;const s=x();let{curRoute:r,session:c}=t;u(e,c,e=>{n("$session",o=e)});let i="",l="",a="",p="",d="",m="";async function f(e){const t=await te(base_url+"/@"+i).catch(e=>{console.log(e)});if(!t)return void n("error",m="login failed");const r=await te(t.endpoints.oauthTokenEndpoint,{method:"POST",body:JSON.stringify({username:i,password:l})});if(r.access_token){let e=o;e.user=t,e.token=r.access_token,s("updatesession",e)}}return e.$set=(e=>{"curRoute"in e&&n("curRoute",r=e.curRoute),"session"in e&&n("session",c=e.session)}),{curRoute:r,session:c,username:i,password:l,description:a,avatar:p,invite:d,error:m,login:f,logout:async function(e){s("updatesession",{})},register:async function(e){let t={username:i,password:l,invite:d,profile:{type:"Person",name:i,summary:a,icon:{type:"Image",mediaType:"image/jpeg",url:p}}};(await fetch(base_url+"/user",{method:"POST",body:JSON.stringify(t)}).then(e=>e.json())).profile&&await f()},$session:o,input0_input_handler:function(){i=this.value,n("username",i)},input1_input_handler:function(){l=this.value,n("password",l)},input2_input_handler:function(){i=this.value,n("username",i)},input3_input_handler:function(){l=this.value,n("password",l)},textarea_input_handler:function(){a=this.value,n("description",a)},input4_input_handler:function(){p=this.value,n("avatar",p)},input5_input_handler:function(){d=this.value,n("invite",d)}}}function mt(t){var n;return{c(){n=m("Minimalist blogging ActivityPub client made with Svelte Could be deployed as\nextension for PubGate, or connected to remote instance Github repo\nhttps://github.com/autogestion/pubgate-philip")},m(e,t){l(e,n,t)},p:e,i:e,o:e,d(e){e&&a(n)}}}function ft(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function ht(e){var n,o,s,r,c,u,p,b,g,R,y,k,x,_,w,T,j,P,S,N,L,O,A,C,U,E,z,D,B,H,M,W,G,Z,q=e.user.name,Y=e.user.summary;let K={ctx:e,current:null,token:null,pending:vt,then:gt,catch:bt,value:"outbox_collection",error:"null",blocks:[,,,]};F(E=e.followers,K);let Q={ctx:e,current:null,token:null,pending:xt,then:yt,catch:Rt,value:"outbox_collection",error:"null",blocks:[,,,]};F(D=e.following,Q);let V={ctx:e,current:null,token:null,pending:jt,then:wt,catch:_t,value:"outbox_collection",error:"null",blocks:[,,,]};F(H=e.liked,V);let X={ctx:e,current:null,token:null,pending:Nt,then:St,catch:Pt,value:"outbox_collection",error:"null",blocks:[,,,]};return F(G=e.timeline,X),{c(){n=d("h2"),o=d("a"),s=m(q),c=f(),u=d("p"),p=d("a"),b=m("Followers"),R=m("\n    |\n    "),y=d("a"),k=m("Following"),_=m("\n    |\n    "),w=d("a"),T=m("Timeline"),P=m("\n    |\n    "),S=d("a"),N=m("Liked"),O=f(),A=d("p"),C=m(Y),U=f(),K.block.c(),z=f(),Q.block.c(),B=f(),V.block.c(),M=f(),W=h(),X.block.c(),$(o,"href",r=e.user.url),$(p,"href",g=e.user.followers),$(y,"href",x=e.user.following),$(w,"href",j=e.user.outbox),$(S,"href",L=e.user.liked)},m(e,t){l(e,n,t),i(n,o),i(o,s),l(e,c,t),l(e,u,t),i(u,p),i(p,b),i(u,R),i(u,y),i(y,k),i(u,_),i(u,w),i(w,T),i(u,P),i(u,S),i(S,N),l(e,O,t),l(e,A,t),i(A,C),l(e,U,t),K.block.m(e,K.anchor=t),K.mount=(()=>z.parentNode),K.anchor=z,l(e,z,t),Q.block.m(e,Q.anchor=t),Q.mount=(()=>B.parentNode),Q.anchor=B,l(e,B,t),V.block.m(e,V.anchor=t),V.mount=(()=>M.parentNode),V.anchor=M,l(e,M,t),l(e,W,t),X.block.m(e,X.anchor=t),X.mount=(()=>W.parentNode),X.anchor=W,Z=!0},p(n,c){e=c,Z&&!n.profile||q===(q=e.user.name)||v(s,q),Z&&!n.profile||r===(r=e.user.url)||$(o,"href",r),Z&&!n.profile||g===(g=e.user.followers)||$(p,"href",g),Z&&!n.profile||x===(x=e.user.following)||$(y,"href",x),Z&&!n.profile||j===(j=e.user.outbox)||$(w,"href",j),Z&&!n.profile||L===(L=e.user.liked)||$(S,"href",L),Z&&!n.profile||Y===(Y=e.user.summary)||v(C,Y),K.ctx=e,"followers"in n&&E!==(E=e.followers)&&F(E,K)||K.block.p(n,t(t({},e),K.resolved)),Q.ctx=e,"following"in n&&D!==(D=e.following)&&F(D,Q)||Q.block.p(n,t(t({},e),Q.resolved)),V.ctx=e,"liked"in n&&H!==(H=e.liked)&&F(H,V)||V.block.p(n,t(t({},e),V.resolved)),X.ctx=e,"timeline"in n&&G!==(G=e.timeline)&&F(G,X)||X.block.p(n,t(t({},e),X.resolved))},i(e){Z||(I(K.block),I(Q.block),I(V.block),I(X.block),Z=!0)},o(e){for(let e=0;e<3;e+=1){J(K.blocks[e])}for(let e=0;e<3;e+=1){J(Q.blocks[e])}for(let e=0;e<3;e+=1){J(V.blocks[e])}for(let e=0;e<3;e+=1){J(X.blocks[e])}Z=!1},d(e){e&&(a(n),a(c),a(u),a(O),a(A),a(U)),K.block.d(e),K.token=null,K=null,e&&a(z),Q.block.d(e),Q.token=null,Q=null,e&&a(B),V.block.d(e),V.token=null,V=null,e&&(a(M),a(W)),X.block.d(e),X.token=null,X=null}}}function bt(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function gt(e){var t,n,o=e.outbox_collection.length&&$t(e);return{c(){o&&o.c(),t=h()},m(e,s){o&&o.m(e,s),l(e,t,s),n=!0},p(e,n){n.outbox_collection.length?o?(o.p(e,n),I(o,1)):((o=$t(n)).c(),I(o,1),o.m(t.parentNode,t)):o&&(U(),J(o,1,1,()=>{o=null}),E())},i(e){n||(I(o),n=!0)},o(e){J(o),n=!1},d(e){o&&o.d(e),e&&a(t)}}}function $t(e){var t,n,o,s=new et({props:{curRoute:e.timelineRoute,session:e.session,outbox_collection:e.outbox_collection}});return{c(){(t=d("h3")).textContent="Followers",n=f(),s.$$.fragment.c()},m(e,r){l(e,t,r),l(e,n,r),z(s,e,r),o=!0},p(e,t){var n={};e.timelineRoute&&(n.curRoute=t.timelineRoute),e.session&&(n.session=t.session),e.followers&&(n.outbox_collection=t.outbox_collection),s.$set(n)},i(e){o||(I(s.$$.fragment,e),o=!0)},o(e){J(s.$$.fragment,e),o=!1},d(e){e&&(a(t),a(n)),D(s,e)}}}function vt(t){var n;return{c(){n=m("Loading followers ..")},m(e,t){l(e,n,t)},p:e,i:e,o:e,d(e){e&&a(n)}}}function Rt(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function yt(e){var t,n,o=e.outbox_collection.length&&kt(e);return{c(){o&&o.c(),t=h()},m(e,s){o&&o.m(e,s),l(e,t,s),n=!0},p(e,n){n.outbox_collection.length?o?(o.p(e,n),I(o,1)):((o=kt(n)).c(),I(o,1),o.m(t.parentNode,t)):o&&(U(),J(o,1,1,()=>{o=null}),E())},i(e){n||(I(o),n=!0)},o(e){J(o),n=!1},d(e){o&&o.d(e),e&&a(t)}}}function kt(e){var t,n,o,s=new et({props:{curRoute:e.timelineRoute,session:e.session,outbox_collection:e.outbox_collection}});return{c(){(t=d("h3")).textContent="Following",n=f(),s.$$.fragment.c()},m(e,r){l(e,t,r),l(e,n,r),z(s,e,r),o=!0},p(e,t){var n={};e.timelineRoute&&(n.curRoute=t.timelineRoute),e.session&&(n.session=t.session),e.following&&(n.outbox_collection=t.outbox_collection),s.$set(n)},i(e){o||(I(s.$$.fragment,e),o=!0)},o(e){J(s.$$.fragment,e),o=!1},d(e){e&&(a(t),a(n)),D(s,e)}}}function xt(t){var n;return{c(){n=m("Loading following ..")},m(e,t){l(e,n,t)},p:e,i:e,o:e,d(e){e&&a(n)}}}function _t(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function wt(e){var t,n,o=e.outbox_collection.length&&Tt(e);return{c(){o&&o.c(),t=h()},m(e,s){o&&o.m(e,s),l(e,t,s),n=!0},p(e,n){n.outbox_collection.length?o?(o.p(e,n),I(o,1)):((o=Tt(n)).c(),I(o,1),o.m(t.parentNode,t)):o&&(U(),J(o,1,1,()=>{o=null}),E())},i(e){n||(I(o),n=!0)},o(e){J(o),n=!1},d(e){o&&o.d(e),e&&a(t)}}}function Tt(e){var t,n,o,s=new et({props:{curRoute:e.timelineRoute,session:e.session,outbox_collection:e.outbox_collection}});return{c(){(t=d("h3")).textContent="Liked",n=f(),s.$$.fragment.c()},m(e,r){l(e,t,r),l(e,n,r),z(s,e,r),o=!0},p(e,t){var n={};e.timelineRoute&&(n.curRoute=t.timelineRoute),e.session&&(n.session=t.session),e.liked&&(n.outbox_collection=t.outbox_collection),s.$set(n)},i(e){o||(I(s.$$.fragment,e),o=!0)},o(e){J(s.$$.fragment,e),o=!1},d(e){e&&(a(t),a(n)),D(s,e)}}}function jt(t){var n;return{c(){n=m("Loading liked posts ..")},m(e,t){l(e,n,t)},p:e,i:e,o:e,d(e){e&&a(n)}}}function Pt(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function St(e){var t,n,o,s=new et({props:{curRoute:e.timelineRoute,session:e.session,outbox_collection:e.outbox_collection}});return{c(){(t=d("h3")).textContent="Posts",n=f(),s.$$.fragment.c()},m(e,r){l(e,t,r),l(e,n,r),z(s,e,r),o=!0},p(e,t){var n={};e.timelineRoute&&(n.curRoute=t.timelineRoute),e.session&&(n.session=t.session),e.timeline&&(n.outbox_collection=t.outbox_collection),s.$set(n)},i(e){o||(I(s.$$.fragment,e),o=!0)},o(e){J(s.$$.fragment,e),o=!1},d(e){e&&(a(t),a(n)),D(s,e)}}}function Nt(t){var n;return{c(){n=m("Loading posts ..")},m(e,t){l(e,n,t)},p:e,i:e,o:e,d(e){e&&a(n)}}}function Lt(t){var n,o,s;return{c(){n=m("Shortly this page will show info about\n  "),o=d("b"),s=m(t.username)},m(e,t){l(e,n,t),l(e,o,t),i(o,s)},p:e,i:e,o:e,d(e){e&&(a(n),a(o))}}}function Ot(e){var n,o,s;let r={ctx:e,current:null,token:null,pending:Lt,then:ht,catch:ft,value:"user",error:"null",blocks:[,,,]};return F(o=e.profile,r),{c(){n=h(),r.block.c()},m(e,t){l(e,n,t),r.block.m(e,r.anchor=t),r.mount=(()=>n.parentNode),r.anchor=n,s=!0},p(n,s){e=s,r.ctx=e,"profile"in n&&o!==(o=e.profile)&&F(o,r)||r.block.p(n,t(t({},e),r.resolved))},i(e){s||(I(r.block),s=!0)},o(e){for(let e=0;e<3;e+=1){J(r.blocks[e])}s=!1},d(e){e&&a(n),r.block.d(e),r.token=null,r=null}}}function At(e,t,n){let o;const s=nt("/search");let{curRoute:r,session:c}=t;u(e,r,e=>{n("$curRoute",o=e)});const i=o.match(/^\/@([^\/]+)$/)[1];let l=null,a=null,p=null,d=null,m={Accept:"application/activity+json"};const f=(e,t=(e=>e))=>fetch(e,{headers:m}).then(e=>e.json()).then(t);let h;return e.$set=(e=>{"curRoute"in e&&n("curRoute",r=e.curRoute),"session"in e&&n("session",c=e.session)}),e.$$.update=((e={$curRoute:1})=>{e.$curRoute&&n("profile",h=(e=>fetch(base_url+e,{headers:m}).then(e=>e.json()).then(e=>(console.log("[User]Fetching timeline",e.outbox),n("timeline",l=f(e.outbox,e=>e.first)),n("followers",a=f(e.followers)),n("following",p=f(e.following)),n("liked",d=f(e.liked)),e)))(o))}),{timelineRoute:s,curRoute:r,session:c,username:i,timeline:l,followers:a,following:p,liked:d,profile:h}}function Ct(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function Ut(e){var t,n=new Ee({props:{post:e.post,session:e.session}});return{c(){n.$$.fragment.c()},m(e,o){z(n,e,o),t=!0},p(e,t){var o={};e.object&&(o.post=t.post),e.session&&(o.session=t.session),n.$set(o)},i(e){t||(I(n.$$.fragment,e),t=!0)},o(e){J(n.$$.fragment,e),t=!1},d(e){D(n,e)}}}function Et(t){var n,o,s;return{c(){n=m("So you want to see object "),o=m(t.id),s=m("?")},m(e,t){l(e,n,t),l(e,o,t),l(e,s,t)},p:e,i:e,o:e,d(e){e&&(a(n),a(o),a(s))}}}function It(e){var n,o,s;let r={ctx:e,current:null,token:null,pending:Et,then:Ut,catch:Ct,value:"post",error:"null",blocks:[,,,]};return F(o=e.object,r),{c(){n=h(),r.block.c()},m(e,t){l(e,n,t),r.block.m(e,r.anchor=t),r.mount=(()=>n.parentNode),r.anchor=n,s=!0},p(n,s){e=s,r.ctx=e,"object"in n&&o!==(o=e.object)&&F(o,r)||r.block.p(n,t(t({},e),r.resolved))},i(e){s||(I(r.block),s=!0)},o(e){for(let e=0;e<3;e+=1){J(r.blocks[e])}s=!1},d(e){e&&a(n),r.block.d(e),r.token=null,r=null}}}function Jt(e,t,n){let o,s,{curRoute:r}=t;u(e,r,e=>{n("$curRoute",o=e)});let{session:c}=t;u(e,c,e=>{n("$session",s=e)});let i=o.match(/^\/@([^\/]+)\/object\/(.+)$/)[2];let l;return e.$set=(e=>{"curRoute"in e&&n("curRoute",r=e.curRoute),"session"in e&&n("session",c=e.session)}),e.$$.update=((e={$curRoute:1,$session:1})=>{(e.$curRoute||e.$session)&&n("object",l=function(e,t={}){return fetch(base_url+e,{headers:{Accept:"application/activity+json"}}).then(e=>e.json()).then(e=>e)}(o,s))}),{curRoute:r,session:c,id:i,object:l}}function Ft(t){var n,o,s;return{c(){n=m("You wanted to see "),o=m(t.$curRoute),s=m(" but we don't have it :/")},m(e,t){l(e,n,t),l(e,o,t),l(e,s,t)},p(e,t){e.$curRoute&&v(o,t.$curRoute)},i:e,o:e,d(e){e&&(a(n),a(o),a(s))}}}function zt(e,t,n){let o,{curRoute:s,session:r}=t;return u(e,s,e=>{n("$curRoute",o=e)}),e.$set=(e=>{"curRoute"in e&&n("curRoute",s=e.curRoute),"session"in e&&n("session",r=e.session)}),{curRoute:s,session:r,$curRoute:o}}const Dt=ot(window.location.pathname),Bt={"/local":{name:"Local Timeline",component:et},"/federated":{name:"Federated Timeline",component:et},"/create":{name:"Create",component:ie},"/search":{name:"Search",component:class extends M{constructor(e){super(),H(this,e,it,ut,c,["session","curRoute"])}}},"/inbox":{name:"Inbox",component:et},"/profile":{name:"Profile",component:class extends M{constructor(e){super(),H(this,e,dt,pt,c,["curRoute","session"])}}},"/about":{name:"About",component:class extends M{constructor(e){super(),H(this,e,null,mt,c,[])}}},user:{component:class extends M{constructor(e){super(),H(this,e,At,Ot,c,["curRoute","session"])}}},object:{component:class extends M{constructor(e){super(),H(this,e,Jt,It,c,["curRoute","session"])}}},error:{component:class extends M{constructor(e){super(),H(this,e,zt,Ft,c,["curRoute","session"])}}}},Ht=ot({});function Mt(e){var t,n,o=e.component;function s(e){return{props:{curRoute:e.curRoute,session:e.session}}}if(o){var r=new o(s(e));r.$on("updatesession",e.updateSession)}return{c(){t=d("div"),r&&r.$$.fragment.c(),$(t,"class","content")},m(e,o){l(e,t,o),r&&z(r,t,null),n=!0},p(e,n){var c={};if(e.curRoute&&(c.curRoute=n.curRoute),e.session&&(c.session=n.session),o!==(o=n.component)){if(r){U();const e=r;J(e.$$.fragment,1,0,()=>{D(e,1)}),E()}o?((r=new o(s(n))).$on("updatesession",n.updateSession),r.$$.fragment.c(),I(r.$$.fragment,1),z(r,t,null)):r=null}else o&&r.$set(c)},i(e){n||(r&&I(r.$$.fragment,e),n=!0)},o(e){r&&J(r.$$.fragment,e),n=!1},d(e){e&&a(t),r&&D(r)}}}function Wt(e,t,n){let o,{routes:s,curRoute:r}=t;u(e,r,e=>{n("$curRoute",o=e)}),"/"===o&&r.set("/local");let c,{updateSession:i,session:l}=t;return k(r.subscribe(e=>{const t=s[o];let r=o.match(/^\/@([^\/]+)\/object\/(.+)$/),u=o.match(/^\/@([^\/]+)$/);t?n("component",c=t.component):r?n("component",c=s.object.component):u&&n("component",c=s.user.component),c||n("component",c=s.error.component)})),e.$set=(e=>{"routes"in e&&n("routes",s=e.routes),"curRoute"in e&&n("curRoute",r=e.curRoute),"updateSession"in e&&n("updateSession",i=e.updateSession),"session"in e&&n("session",l=e.session)}),{routes:s,curRoute:r,updateSession:i,session:l,component:c}}class Gt extends M{constructor(e){super(),H(this,e,Wt,Mt,c,["routes","curRoute","updateSession","session"])}}function Zt(e){var t,n,o,s=new V({props:{routes:Bt,curRoute:Dt,selectTab:qt,session:Ht,pgi:e.pgi}}),r=new Gt({props:{routes:Bt,curRoute:Dt,session:Ht,updateSession:e.updateSession}}),c=new ee({});return{c(){s.$$.fragment.c(),t=f(),r.$$.fragment.c(),n=f(),c.$$.fragment.c()},m(e,u){z(s,e,u),l(e,t,u),z(r,e,u),l(e,n,u),z(c,e,u),o=!0},p(e,t){var n={};e.routes&&(n.routes=Bt),e.curRoute&&(n.curRoute=Dt),e.selectTab&&(n.selectTab=qt),e.session&&(n.session=Ht),e.pgi&&(n.pgi=t.pgi),s.$set(n);var o={};e.routes&&(o.routes=Bt),e.curRoute&&(o.curRoute=Dt),e.session&&(o.session=Ht),e.updateSession&&(o.updateSession=t.updateSession),r.$set(o)},i(e){o||(I(s.$$.fragment,e),I(r.$$.fragment,e),I(c.$$.fragment,e),o=!0)},o(e){J(s.$$.fragment,e),J(r.$$.fragment,e),J(c.$$.fragment,e),o=!1},d(e){D(s,e),e&&a(t),D(r,e),e&&a(n),D(c,e)}}}function qt(e){const t=e.pathname;Array.prototype.forEach.call(e.parentNode.parentNode.children,(e,n)=>{e.firstChild.href.split("/")[1]!==t&&e.firstChild.classList.remove("header-selected")}),e.classList.add("header-selected")}function Yt(e,t,n){let o;u(e,Ht,e=>{n("$session",o=e)});let s=pubgate_instance;const r=(e,t)=>{localStorage.setItem(e,JSON.stringify(t))};return Ht.set((e=>JSON.parse(localStorage.getItem(e)))("session")||{}),{pgi:s,updateSession:e=>{Ht.set(e.detail),r("session",o)}}}return new class extends M{constructor(e){super(),H(this,e,Yt,Zt,c,[])}}({target:document.body,props:{name:"app"}})}();
//# sourceMappingURL=bundle.js.map
